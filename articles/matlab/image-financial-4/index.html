<html>
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
        <title>MATLAB金融工具箱：04：缺失数据的资本资产定价模型</title>
        <link rel="stylesheet" type="text/css" media="all" href="../../../style.css">
    </head>
    <body class="post-template-default single single-post postid-14 single-format-standard logged-in admin-bar single-author singular two-column left-sidebar customize-support">
        <div id="page" class="hfeed">
            <div id="main">
                <div id="primary">
                    <div id="content" role="main">        
                        <article id="post-14" class="post-14 post type-post status-publish format-standard hentry category-18">
                            <header class="entry-header">
                                <h1 class="entry-title">MATLAB金融工具箱：04：缺失数据的资本资产定价模型</h1>
                            </header>
                            <div class="entry-content">
<br><a href="../../../index.html"> Home </a> 
<br>
<br>
<p>
<p data-first-child data-pid="h9-m-6Wq">此示例说明了在缺失数据的情况下资本资产定价模型（CAPM）的实现。</p><h3><b>资本资产定价模型</b></h3><p data-pid="Gbo-AjpO">资本资产定价模型（CAPM）是一种古老的工具，但经常被用来描述资产和市场价格之间联动的特征。尽管在其实施和解释中会出现许多问题，但从业人员面临的一个问题是使用不完整的股价数据估算CAPM的系数。</p><p data-pid="NeoYB7vb">在参考文献中许多假设（参见Sharpe [3]，Lintner [2]，Jarrow [1]和Sharpe等人[4]）条件下，CAPM得出结论：资产收益具有线性与市场收益的关系。具体来说，给定组成市场的所有股票<code>M</code>的收益为，无风险资产的收益为<code>C</code>，CAPM指出市场中每种资产<code>R(i)</code>的收益具有预期形式：</p><div class="highlight"><pre><code class="language-matlab"> <span class="n">E</span><span class="p">[</span><span class="n">R</span><span class="p">(</span><span class="nb">i</span><span class="p">)]</span> <span class="p">=</span> <span class="n">C</span> <span class="o">+</span> <span class="n">b</span><span class="p">(</span><span class="nb">i</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">E</span><span class="p">[</span><span class="n">M</span><span class="p">]</span> <span class="o">-</span> <span class="n">C</span><span class="p">)</span></code></pre></div><p data-pid="DJRUkjxK">其中资产<code>i = 1, ... , n</code>，<code>b(i)</code>是一个参数，用于指定给定资产与基础市场之间的联动程度。换句话说，每种资产的预期收益等于无风险资产的收益加上经过风险调整的预期市场收益减去无风险资产收益。参数的集合<code>b(1), ... , b(n)</code>称为资产beta值。</p><p data-pid="uqE4W2c6">请注意，资产beta值具有以下形式</p><div class="highlight"><pre><code class="language-matlab"> <span class="n">b</span><span class="p">(</span><span class="nb">i</span><span class="p">)</span> <span class="p">=</span> <span class="n">cov</span><span class="p">(</span><span class="n">R</span><span class="p">(</span><span class="nb">i</span><span class="p">),</span><span class="n">M</span><span class="p">)</span><span class="o">/</span><span class="n">var</span><span class="p">(</span><span class="n">M</span><span class="p">)</span></code></pre></div><p data-pid="TYkoRjLC">这是资产与市场收益之间的协方差除以市场收益方差的比率。如果某资产的beta值等于1，则该资产被称为随市场移动；如果资产的beta值大于1，则该资产的波动性要大于市场；如果资产的beta值小于1，则该资产的波动性要小于市场。</p><h3><b>CAPM的估算</b></h3><p data-pid="LtamQ23y">用于估计的CAPM模型的标准形式是线性模型，其中每个资产都有附加参数以表征残差。对于每个具有<code>m</code>观察样本的<code>n</code>的资产收益率<code>R(k, i)</code>，市场收益率<code>M(k)</code>和无风险资产收益率样本的资产<code>C(k)</code>，估计模型具有以下形式：</p><div class="highlight"><pre><code class="language-matlab"> <span class="n">R</span><span class="p">(</span><span class="n">k</span><span class="p">,</span><span class="nb">i</span><span class="p">)</span> <span class="p">=</span> <span class="n">a</span><span class="p">(</span><span class="nb">i</span><span class="p">)</span> <span class="o">+</span> <span class="n">C</span><span class="p">(</span><span class="n">k</span><span class="p">)</span> <span class="o">+</span> <span class="n">b</span><span class="p">(</span><span class="nb">i</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">M</span><span class="p">(</span><span class="n">k</span><span class="p">)</span> <span class="o">-</span> <span class="n">C</span><span class="p">(</span><span class="n">k</span><span class="p">))</span> <span class="o">+</span> <span class="n">V</span><span class="p">(</span><span class="n">k</span><span class="p">,</span><span class="nb">i</span><span class="p">)</span></code></pre></div><p data-pid="ATitFE0A">其中样本<code>k = 1, ... , m</code>，资产<code>i = 1, ... , n</code>，其中<code>a(i)</code>是参数，它指定资产的非系统性收益，<code>b(i)</code>是beta系数，<code>V(k,i)</code>是每项资产关联随机变量<code>V(i)</code>的残差。</p><p data-pid="7P49kMgD">参数的集合<code>a(1), ... , a(n)</code>称为资产alpha值。CAPM的严格形式规定alpha值必须为零，并且与零的偏差是暂时失衡的结果。然而，实际上，资产可能具有非零的alpha值，在这种情况下，许多积极的投资管理都专门用于搜索具有可利用的非零alpha值的资产。</p><p data-pid="Q94ImqVc">为了考虑非零的alpha值的可能性，估计模型通常寻求估计alpha值并执行测试以确定alpha值是否在统计上等于零。</p><p data-pid="sQskAuTy"><code>V(i)</code>假定残差具有矩</p><div class="highlight"><pre><code class="language-matlab"> <span class="n">E</span><span class="p">[</span><span class="n">V</span><span class="p">(</span><span class="nb">i</span><span class="p">)]</span> <span class="p">=</span> <span class="mi">0</span></code></pre></div><p data-pid="2YPlOn9_">和</p><div class="highlight"><pre><code class="language-matlab"> <span class="n">E</span><span class="p">[</span><span class="n">V</span><span class="p">(</span><span class="nb">i</span><span class="p">)</span> <span class="o">*</span> <span class="n">V</span><span class="p">(</span><span class="nb">j</span><span class="p">)]</span> <span class="p">=</span> <span class="n">S</span><span class="p">(</span><span class="nb">i</span><span class="p">,</span><span class="nb">j</span><span class="p">)</span></code></pre></div><p data-pid="aQtEcubH">其中资产<code>i,j = 1, ... , n</code>，其中参数<code>S(1,1), ... , S(n,n)</code>称为残差或非系统方差/协方差。</p><p data-pid="W1uc0rUN">各项资产残差的平方根<code>sqrt(S(i,i))</code>，<code>i = 1, ... , n</code>，称为该资产的剩余或非系统风险，因为它刻画了无法用变化的市场价格解释的资产价格残差。</p><h3><b>缺失数据的估计</b></h3><p data-pid="bmuwLCsM">尽管可以为资产回报历史悠久的公司估算beta值，但要为最近的IPO估算beta值极为困难。但是，如果存在可以观察到的，与新公司的股价走势具有某种程度相关性的公司集合，例如与新公司处于同一行业的公司，则有可能使用Financial Toolbox™中的缺失数据回归例程来估算值新公司beta值。</p><h3><b>某些技术股票Beta值的单独估算</b></h3><p data-pid="EF9VEy2T">为了说明如何使用缺失数据回归例程，我们将估算12只科技股的beta值，其中一只股票（GOOG）是新发股票。</p><p data-pid="f1_Pec9o">首先，从MAT文件<code>CAPMuniverse</code>中加载十二只股票的日期，总收益和股票代码。</p><div class="highlight"><pre><code class="language-matlab"> <span class="n">load</span> <span class="n">CAPMuniverse</span>
 <span class="n">whos</span> <span class="n">Assets</span> <span class="n">Data</span> <span class="n">Dates</span>
   <span class="n">Name</span>           <span class="n">Size</span>             <span class="n">Bytes</span>  <span class="n">Class</span>     <span class="n">Attributes</span>
 ​
   <span class="n">Assets</span>         <span class="mi">1</span><span class="n">x14</span>              <span class="mi">1568</span>  <span class="n">cell</span>                
   <span class="n">Data</span>        <span class="mi">1471</span><span class="n">x14</span>            <span class="mi">164752</span>  <span class="n">double</span>              
   <span class="n">Dates</span>       <span class="mi">1471</span><span class="n">x1</span>              <span class="mi">11768</span>  <span class="n">double</span>              </code></pre></div><p data-pid="81o3e3w_">模型中的资产描述如下，其中后两个序列代表市场和无风险资产。</p><div class="highlight"><pre><code class="language-matlab"> <span class="n">Assets</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">7</span><span class="p">)</span>
 <span class="nb">ans</span> <span class="p">=</span> <span class="mi">1</span><span class="n">x7</span> <span class="n">cell</span>
   <span class="n">Columns</span> <span class="mi">1</span> <span class="n">through</span> <span class="mi">6</span>
 ​
     <span class="p">{</span><span class="s">&#39;AAPL&#39;</span><span class="p">}</span>    <span class="p">{</span><span class="s">&#39;AMZN&#39;</span><span class="p">}</span>    <span class="p">{</span><span class="s">&#39;CSCO&#39;</span><span class="p">}</span>    <span class="p">{</span><span class="s">&#39;DELL&#39;</span><span class="p">}</span>    <span class="p">{</span><span class="s">&#39;EBAY&#39;</span><span class="p">}</span>    <span class="p">{</span><span class="s">&#39;GOOG&#39;</span><span class="p">}</span>
 ​
   <span class="n">Column</span> <span class="mi">7</span>
 ​
     <span class="p">{</span><span class="s">&#39;HPQ&#39;</span><span class="p">}</span>
 <span class="n">Assets</span><span class="p">(</span><span class="mi">8</span><span class="p">:</span><span class="mi">14</span><span class="p">)</span>
 <span class="nb">ans</span> <span class="p">=</span> <span class="mi">1</span><span class="n">x7</span> <span class="n">cell</span>
   <span class="n">Columns</span> <span class="mi">1</span> <span class="n">through</span> <span class="mi">6</span>
 ​
     <span class="p">{</span><span class="s">&#39;IBM&#39;</span><span class="p">}</span>    <span class="p">{</span><span class="s">&#39;INTC&#39;</span><span class="p">}</span>    <span class="p">{</span><span class="s">&#39;MSFT&#39;</span><span class="p">}</span>    <span class="p">{</span><span class="s">&#39;ORCL&#39;</span><span class="p">}</span>    <span class="p">{</span><span class="s">&#39;YHOO&#39;</span><span class="p">}</span>    <span class="p">{</span><span class="s">&#39;MARKET&#39;</span><span class="p">}</span>
 ​
   <span class="n">Column</span> <span class="mi">7</span>
 ​
     <span class="p">{</span><span class="s">&#39;CASH&#39;</span><span class="p">}</span></code></pre></div><p data-pid="4MRvZZ5B">数据涵盖了2000年1月1日至2005年11月7日期间的每日总收益。这里的两只股票有缺失值，以NaN表示。两只股票中的一只在此期间进行了首次公开募股，因此数据远远少于其他两只股票。</p><p data-pid="_5Ssae9P">第一步是为每只股票计算单独的回归，其中有缺失数据的股票具有反映其低观察性的估计。</p><div class="highlight"><pre><code class="language-matlab"> <span class="p">[</span><span class="n">NumSamples</span><span class="p">,</span> <span class="n">NumSeries</span><span class="p">]</span> <span class="p">=</span> <span class="nb">size</span><span class="p">(</span><span class="n">Data</span><span class="p">);</span>
 <span class="n">NumAssets</span> <span class="p">=</span> <span class="n">NumSeries</span> <span class="o">-</span> <span class="mi">2</span><span class="p">;</span>
 ​
 <span class="n">StartDate</span> <span class="p">=</span> <span class="n">Dates</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
 <span class="n">EndDate</span> <span class="p">=</span> <span class="n">Dates</span><span class="p">(</span><span class="k">end</span><span class="p">);</span>
 ​
 <span class="n">Alpha</span> <span class="p">=</span> <span class="n">NaN</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">length</span><span class="p">(</span><span class="n">NumAssets</span><span class="p">));</span>
 <span class="n">Beta</span> <span class="p">=</span> <span class="n">NaN</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">length</span><span class="p">(</span><span class="n">NumAssets</span><span class="p">));</span>
 <span class="n">Sigma</span> <span class="p">=</span> <span class="n">NaN</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">length</span><span class="p">(</span><span class="n">NumAssets</span><span class="p">));</span>
 <span class="n">StdAlpha</span> <span class="p">=</span> <span class="n">NaN</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">length</span><span class="p">(</span><span class="n">NumAssets</span><span class="p">));</span>
 <span class="n">StdBeta</span> <span class="p">=</span> <span class="n">NaN</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">length</span><span class="p">(</span><span class="n">NumAssets</span><span class="p">));</span>
 <span class="n">StdSigma</span> <span class="p">=</span> <span class="n">NaN</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">length</span><span class="p">(</span><span class="n">NumAssets</span><span class="p">));</span>
 <span class="k">for</span> <span class="nb">i</span> <span class="p">=</span> <span class="mi">1</span><span class="p">:</span><span class="n">NumAssets</span>
     <span class="c">% Set up separate asset data and design matrices</span>
     <span class="n">TestData</span> <span class="p">=</span> <span class="nb">zeros</span><span class="p">(</span><span class="n">NumSamples</span><span class="p">,</span><span class="mi">1</span><span class="p">);</span>
     <span class="n">TestDesign</span> <span class="p">=</span> <span class="nb">zeros</span><span class="p">(</span><span class="n">NumSamples</span><span class="p">,</span><span class="mi">2</span><span class="p">);</span>
 ​
     <span class="n">TestData</span><span class="p">(:)</span> <span class="p">=</span> <span class="n">Data</span><span class="p">(:,</span><span class="nb">i</span><span class="p">)</span> <span class="o">-</span> <span class="n">Data</span><span class="p">(:,</span><span class="mi">14</span><span class="p">);</span>
     <span class="n">TestDesign</span><span class="p">(:,</span><span class="mi">1</span><span class="p">)</span> <span class="p">=</span> <span class="mf">1.0</span><span class="p">;</span>
     <span class="n">TestDesign</span><span class="p">(:,</span><span class="mi">2</span><span class="p">)</span> <span class="p">=</span> <span class="n">Data</span><span class="p">(:,</span><span class="mi">13</span><span class="p">)</span> <span class="o">-</span> <span class="n">Data</span><span class="p">(:,</span><span class="mi">14</span><span class="p">);</span>
 ​
     <span class="c">% Estimate CAPM for each asset separately</span>
     <span class="p">[</span><span class="n">Param</span><span class="p">,</span> <span class="n">Covar</span><span class="p">]</span> <span class="p">=</span> <span class="n">ecmmvnrmle</span><span class="p">(</span><span class="n">TestData</span><span class="p">,</span> <span class="n">TestDesign</span><span class="p">);</span>
 ​
     <span class="c">% Estimate ideal standard errors for covariance parameters</span>
     <span class="p">[</span><span class="n">StdParam</span><span class="p">,</span> <span class="n">StdCovar</span><span class="p">]</span> <span class="p">=</span> <span class="n">ecmmvnrstd</span><span class="p">(</span><span class="n">TestData</span><span class="p">,</span> <span class="n">TestDesign</span><span class="p">,</span> <span class="n">Covar</span><span class="p">,</span> <span class="s">&#39;fisher&#39;</span><span class="p">);</span>
     
     <span class="c">% Estimate sample standard errors for model parameters</span>
     <span class="n">StdParam</span> <span class="p">=</span> <span class="n">ecmmvnrstd</span><span class="p">(</span><span class="n">TestData</span><span class="p">,</span> <span class="n">TestDesign</span><span class="p">,</span> <span class="n">Covar</span><span class="p">,</span> <span class="s">&#39;hessian&#39;</span><span class="p">);</span>
 ​
     <span class="c">% Set up results for output</span>
     <span class="n">Alpha</span><span class="p">(</span><span class="nb">i</span><span class="p">)</span> <span class="p">=</span> <span class="n">Param</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
     <span class="n">Beta</span><span class="p">(</span><span class="nb">i</span><span class="p">)</span> <span class="p">=</span> <span class="n">Param</span><span class="p">(</span><span class="mi">2</span><span class="p">);</span>
     <span class="n">Sigma</span><span class="p">(</span><span class="nb">i</span><span class="p">)</span> <span class="p">=</span> <span class="nb">sqrt</span><span class="p">(</span><span class="n">Covar</span><span class="p">);</span>
 ​
     <span class="n">StdAlpha</span><span class="p">(</span><span class="nb">i</span><span class="p">)</span> <span class="p">=</span> <span class="n">StdParam</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
     <span class="n">StdBeta</span><span class="p">(</span><span class="nb">i</span><span class="p">)</span> <span class="p">=</span> <span class="n">StdParam</span><span class="p">(</span><span class="mi">2</span><span class="p">);</span>
     <span class="n">StdSigma</span><span class="p">(</span><span class="nb">i</span><span class="p">)</span> <span class="p">=</span> <span class="nb">sqrt</span><span class="p">(</span><span class="n">StdCovar</span><span class="p">);</span>
 <span class="k">end</span>
 ​
 <span class="n">displaySummary</span><span class="p">(</span><span class="s">&#39;Separate&#39;</span><span class="p">,</span> <span class="n">StartDate</span><span class="p">,</span> <span class="n">EndDate</span><span class="p">,</span> <span class="n">NumAssets</span><span class="p">,</span> <span class="n">Assets</span><span class="p">,</span> <span class="n">Alpha</span><span class="p">,</span> <span class="n">StdAlpha</span><span class="p">,</span> <span class="n">Beta</span><span class="p">,</span> <span class="n">StdBeta</span><span class="p">,</span> <span class="n">Sigma</span><span class="p">,</span> <span class="n">StdSigma</span><span class="p">)</span>
 <span class="n">Separate</span> <span class="n">regression</span> <span class="n">with</span> <span class="n">daily</span> <span class="n">total</span> <span class="k">return</span> <span class="n">data</span> <span class="n">from</span> <span class="mi">03</span><span class="o">-</span><span class="n">Jan</span><span class="o">-</span><span class="mi">2000</span> <span class="n">to</span> <span class="mi">07</span><span class="o">-</span><span class="n">Nov</span><span class="o">-</span><span class="mi">2005</span> <span class="c">...</span>
        <span class="n">Alpha</span>                <span class="n">Beta</span>                 <span class="n">Sigma</span>               
   <span class="o">----</span> <span class="o">--------------------</span> <span class="o">--------------------</span> <span class="o">--------------------</span>
   <span class="n">AAPL</span>    <span class="mf">0.0012</span> <span class="p">(</span>  <span class="mf">1.3882</span><span class="p">)</span>    <span class="mf">1.2294</span> <span class="p">(</span> <span class="mf">17.1839</span><span class="p">)</span>    <span class="mf">0.0322</span> <span class="p">(</span>  <span class="mf">0.0062</span><span class="p">)</span>
   <span class="n">AMZN</span>    <span class="mf">0.0006</span> <span class="p">(</span>  <span class="mf">0.5326</span><span class="p">)</span>    <span class="mf">1.3661</span> <span class="p">(</span> <span class="mf">13.6579</span><span class="p">)</span>    <span class="mf">0.0449</span> <span class="p">(</span>  <span class="mf">0.0086</span><span class="p">)</span>
   <span class="n">CSCO</span>   <span class="o">-</span><span class="mf">0.0002</span> <span class="p">(</span>  <span class="mf">0.2878</span><span class="p">)</span>    <span class="mf">1.5653</span> <span class="p">(</span> <span class="mf">23.6085</span><span class="p">)</span>    <span class="mf">0.0298</span> <span class="p">(</span>  <span class="mf">0.0057</span><span class="p">)</span>
   <span class="n">DELL</span>   <span class="o">-</span><span class="mf">0.0000</span> <span class="p">(</span>  <span class="mf">0.0368</span><span class="p">)</span>    <span class="mf">1.2594</span> <span class="p">(</span> <span class="mf">22.2164</span><span class="p">)</span>    <span class="mf">0.0255</span> <span class="p">(</span>  <span class="mf">0.0049</span><span class="p">)</span>
   <span class="n">EBAY</span>    <span class="mf">0.0014</span> <span class="p">(</span>  <span class="mf">1.4326</span><span class="p">)</span>    <span class="mf">1.3441</span> <span class="p">(</span> <span class="mf">16.0732</span><span class="p">)</span>    <span class="mf">0.0376</span> <span class="p">(</span>  <span class="mf">0.0072</span><span class="p">)</span>
   <span class="n">GOOG</span>    <span class="mf">0.0046</span> <span class="p">(</span>  <span class="mf">3.2107</span><span class="p">)</span>    <span class="mf">0.3742</span> <span class="p">(</span>  <span class="mf">1.7328</span><span class="p">)</span>    <span class="mf">0.0252</span> <span class="p">(</span>  <span class="mf">0.0071</span><span class="p">)</span>
    <span class="n">HPQ</span>    <span class="mf">0.0001</span> <span class="p">(</span>  <span class="mf">0.1747</span><span class="p">)</span>    <span class="mf">1.3745</span> <span class="p">(</span> <span class="mf">24.2390</span><span class="p">)</span>    <span class="mf">0.0255</span> <span class="p">(</span>  <span class="mf">0.0049</span><span class="p">)</span>
    <span class="n">IBM</span>   <span class="o">-</span><span class="mf">0.0000</span> <span class="p">(</span>  <span class="mf">0.0312</span><span class="p">)</span>    <span class="mf">1.0807</span> <span class="p">(</span> <span class="mf">28.7576</span><span class="p">)</span>    <span class="mf">0.0169</span> <span class="p">(</span>  <span class="mf">0.0032</span><span class="p">)</span>
   <span class="n">INTC</span>    <span class="mf">0.0001</span> <span class="p">(</span>  <span class="mf">0.1608</span><span class="p">)</span>    <span class="mf">1.6002</span> <span class="p">(</span> <span class="mf">27.3684</span><span class="p">)</span>    <span class="mf">0.0263</span> <span class="p">(</span>  <span class="mf">0.0050</span><span class="p">)</span>
   <span class="n">MSFT</span>   <span class="o">-</span><span class="mf">0.0002</span> <span class="p">(</span>  <span class="mf">0.4871</span><span class="p">)</span>    <span class="mf">1.1765</span> <span class="p">(</span> <span class="mf">27.4554</span><span class="p">)</span>    <span class="mf">0.0193</span> <span class="p">(</span>  <span class="mf">0.0037</span><span class="p">)</span>
   <span class="n">ORCL</span>    <span class="mf">0.0000</span> <span class="p">(</span>  <span class="mf">0.0389</span><span class="p">)</span>    <span class="mf">1.5010</span> <span class="p">(</span> <span class="mf">21.1855</span><span class="p">)</span>    <span class="mf">0.0319</span> <span class="p">(</span>  <span class="mf">0.0061</span><span class="p">)</span>
   <span class="n">YHOO</span>    <span class="mf">0.0001</span> <span class="p">(</span>  <span class="mf">0.1282</span><span class="p">)</span>    <span class="mf">1.6543</span> <span class="p">(</span> <span class="mf">19.3838</span><span class="p">)</span>    <span class="mf">0.0384</span> <span class="p">(</span>  <span class="mf">0.0074</span><span class="p">)</span></code></pre></div><p data-pid="ba7vla7u">该<code>Alpha</code>列包含每只股票的alpha值估计值，预期值接近零。此外，t统计量（括号里的值）通常会拒绝在99.5％的显着性水平下，alpha值非零的假设。</p><p data-pid="6vFK0E7l">该<code>Beta</code>列包含每只股票的beta值估计值，括号中还包含t统计量。对于除GOOG以外的所有股票，均以99.5％的显着性水平接受beta值非零的假设。但是，GOOG似乎没有足够的数据来获取有意义的beta估计值，因为它的t统计量表示拒绝非零beta值的假设。</p><p data-pid="cwv9T9GI">该<code>Sigma</code>列包含残余标准偏差，即非系统风险的估计值。代替t统计量的是括号中与残留标准偏差关联的标准误差。</p><h3><b>一些技术股票Beta值的分组估计</b></h3><p data-pid="z0CHjaQZ">要估算所有12只股票的beta值，请建立一个联合回归模型，将所有12只股票放在一组中（由于每只股票具有相同的设计矩阵，因此该模型实际上是看似无关的回归）。估计模型参数的函数是<code>ecmmvnrmle</code>，估计标准误差的函数是<code>ecmmvnrstd</code>。</p><p data-pid="PmFbA5j_">由于GOOG具有大量的缺失值，因此直接使用缺失数据函数<code>ecmmvnrmle</code>需要482次迭代才能收敛。计算可能需要很长时间。为简洁起见，前480次迭代后的参数和协方差估计值包含在MAT文件（<code>CAPMgroupparam</code>）中，并将用作计算股票beta的初始估计值。</p><div class="highlight"><pre><code class="language-matlab"> <span class="n">load</span> <span class="n">CAPMgroupparam</span>
 <span class="n">whos</span> <span class="n">Param0</span> <span class="n">Covar0</span>
   <span class="n">Name</span>         <span class="n">Size</span>            <span class="n">Bytes</span>  <span class="n">Class</span>     <span class="n">Attributes</span>
 ​
   <span class="n">Covar0</span>      <span class="mi">12</span><span class="n">x12</span>             <span class="mi">1152</span>  <span class="n">double</span>              
   <span class="n">Param0</span>      <span class="mi">24</span><span class="n">x1</span>               <span class="mi">192</span>  <span class="n">double</span>              </code></pre></div><p data-pid="NaktaYas">现在，估计用于十二只股票集合的参数。</p><div class="highlight"><pre><code class="language-matlab"> <span class="n">NumParams</span> <span class="p">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">NumAssets</span><span class="p">;</span>
 ​
 <span class="c">% Set up grouped asset data and design matrices</span>
 <span class="n">TestData</span> <span class="p">=</span> <span class="nb">zeros</span><span class="p">(</span><span class="n">NumSamples</span><span class="p">,</span> <span class="n">NumAssets</span><span class="p">);</span>
 <span class="n">TestDesign</span> <span class="p">=</span> <span class="n">cell</span><span class="p">(</span><span class="n">NumSamples</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
 <span class="n">Design</span> <span class="p">=</span> <span class="nb">zeros</span><span class="p">(</span><span class="n">NumAssets</span><span class="p">,</span> <span class="n">NumParams</span><span class="p">);</span>
 ​
 <span class="k">for</span> <span class="n">k</span> <span class="p">=</span> <span class="mi">1</span><span class="p">:</span><span class="n">NumSamples</span>
     <span class="k">for</span> <span class="nb">i</span> <span class="p">=</span> <span class="mi">1</span><span class="p">:</span><span class="n">NumAssets</span>
         <span class="n">TestData</span><span class="p">(</span><span class="n">k</span><span class="p">,</span><span class="nb">i</span><span class="p">)</span> <span class="p">=</span> <span class="n">Data</span><span class="p">(</span><span class="n">k</span><span class="p">,</span><span class="nb">i</span><span class="p">)</span> <span class="o">-</span> <span class="n">Data</span><span class="p">(</span><span class="n">k</span><span class="p">,</span><span class="mi">14</span><span class="p">);</span>
         <span class="n">Design</span><span class="p">(</span><span class="nb">i</span><span class="p">,</span><span class="mi">2</span><span class="o">*</span><span class="nb">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="p">=</span> <span class="mf">1.0</span><span class="p">;</span>
         <span class="n">Design</span><span class="p">(</span><span class="nb">i</span><span class="p">,</span><span class="mi">2</span><span class="o">*</span><span class="nb">i</span><span class="p">)</span> <span class="p">=</span> <span class="n">Data</span><span class="p">(</span><span class="n">k</span><span class="p">,</span><span class="mi">13</span><span class="p">)</span> <span class="o">-</span> <span class="n">Data</span><span class="p">(</span><span class="n">k</span><span class="p">,</span><span class="mi">14</span><span class="p">);</span>
     <span class="k">end</span>
     <span class="n">TestDesign</span><span class="p">{</span><span class="n">k</span><span class="p">}</span> <span class="p">=</span> <span class="n">Design</span><span class="p">;</span>
 <span class="k">end</span>
 ​
 <span class="c">% Estimate CAPM for all assets together with initial parameter estimates</span>
 <span class="p">[</span><span class="n">Param</span><span class="p">,</span> <span class="n">Covar</span><span class="p">]</span> <span class="p">=</span> <span class="n">ecmmvnrmle</span><span class="p">(</span><span class="n">TestData</span><span class="p">,</span> <span class="n">TestDesign</span><span class="p">,</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[],</span> <span class="n">Param0</span><span class="p">,</span> <span class="n">Covar0</span><span class="p">);</span>
 ​
 <span class="c">% Estimate ideal standard errors for covariance parameters</span>
 <span class="p">[</span><span class="n">StdParam</span><span class="p">,</span> <span class="n">StdCovar</span><span class="p">]</span> <span class="p">=</span> <span class="n">ecmmvnrstd</span><span class="p">(</span><span class="n">TestData</span><span class="p">,</span> <span class="n">TestDesign</span><span class="p">,</span> <span class="n">Covar</span><span class="p">,</span> <span class="s">&#39;fisher&#39;</span><span class="p">);</span>
 ​
 <span class="c">% Estimate sample standard errors for model parameters</span>
 <span class="n">StdParam</span> <span class="p">=</span> <span class="n">ecmmvnrstd</span><span class="p">(</span><span class="n">TestData</span><span class="p">,</span> <span class="n">TestDesign</span><span class="p">,</span> <span class="n">Covar</span><span class="p">,</span> <span class="s">&#39;hessian&#39;</span><span class="p">);</span>
 ​
 <span class="c">% Set up results for output</span>
 <span class="n">Alpha</span> <span class="p">=</span> <span class="n">Param</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">2</span><span class="p">:</span><span class="k">end</span><span class="o">-</span><span class="mi">1</span><span class="p">);</span>
 <span class="n">Beta</span> <span class="p">=</span> <span class="n">Param</span><span class="p">(</span><span class="mi">2</span><span class="p">:</span><span class="mi">2</span><span class="p">:</span><span class="k">end</span><span class="p">);</span>
 <span class="n">Sigma</span> <span class="p">=</span> <span class="nb">sqrt</span><span class="p">(</span><span class="nb">diag</span><span class="p">(</span><span class="n">Covar</span><span class="p">));</span>
 ​
 <span class="n">StdAlpha</span> <span class="p">=</span> <span class="n">StdParam</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">2</span><span class="p">:</span><span class="k">end</span><span class="o">-</span><span class="mi">1</span><span class="p">);</span>
 <span class="n">StdBeta</span> <span class="p">=</span> <span class="n">StdParam</span><span class="p">(</span><span class="mi">2</span><span class="p">:</span><span class="mi">2</span><span class="p">:</span><span class="k">end</span><span class="p">);</span>
 <span class="n">StdSigma</span> <span class="p">=</span> <span class="nb">sqrt</span><span class="p">(</span><span class="nb">diag</span><span class="p">(</span><span class="n">StdCovar</span><span class="p">));</span>
 ​
 <span class="n">displaySummary</span><span class="p">(</span><span class="s">&#39;Grouped&#39;</span><span class="p">,</span> <span class="n">StartDate</span><span class="p">,</span> <span class="n">EndDate</span><span class="p">,</span> <span class="n">NumAssets</span><span class="p">,</span> <span class="n">Assets</span><span class="p">,</span> <span class="n">Alpha</span><span class="p">,</span> <span class="n">StdAlpha</span><span class="p">,</span> <span class="n">Beta</span><span class="p">,</span> <span class="n">StdBeta</span><span class="p">,</span> <span class="n">Sigma</span><span class="p">,</span> <span class="n">StdSigma</span><span class="p">)</span>
 <span class="n">Grouped</span> <span class="n">regression</span> <span class="n">with</span> <span class="n">daily</span> <span class="n">total</span> <span class="k">return</span> <span class="n">data</span> <span class="n">from</span> <span class="mi">03</span><span class="o">-</span><span class="n">Jan</span><span class="o">-</span><span class="mi">2000</span> <span class="n">to</span> <span class="mi">07</span><span class="o">-</span><span class="n">Nov</span><span class="o">-</span><span class="mi">2005</span> <span class="c">...</span>
        <span class="n">Alpha</span>                <span class="n">Beta</span>                 <span class="n">Sigma</span>               
   <span class="o">----</span> <span class="o">--------------------</span> <span class="o">--------------------</span> <span class="o">--------------------</span>
   <span class="n">AAPL</span>    <span class="mf">0.0012</span> <span class="p">(</span>  <span class="mf">1.3882</span><span class="p">)</span>    <span class="mf">1.2294</span> <span class="p">(</span> <span class="mf">17.1839</span><span class="p">)</span>    <span class="mf">0.0322</span> <span class="p">(</span>  <span class="mf">0.0062</span><span class="p">)</span>
   <span class="n">AMZN</span>    <span class="mf">0.0007</span> <span class="p">(</span>  <span class="mf">0.6086</span><span class="p">)</span>    <span class="mf">1.3673</span> <span class="p">(</span> <span class="mf">13.6427</span><span class="p">)</span>    <span class="mf">0.0450</span> <span class="p">(</span>  <span class="mf">0.0086</span><span class="p">)</span>
   <span class="n">CSCO</span>   <span class="o">-</span><span class="mf">0.0002</span> <span class="p">(</span>  <span class="mf">0.2878</span><span class="p">)</span>    <span class="mf">1.5653</span> <span class="p">(</span> <span class="mf">23.6085</span><span class="p">)</span>    <span class="mf">0.0298</span> <span class="p">(</span>  <span class="mf">0.0057</span><span class="p">)</span>
   <span class="n">DELL</span>   <span class="o">-</span><span class="mf">0.0000</span> <span class="p">(</span>  <span class="mf">0.0368</span><span class="p">)</span>    <span class="mf">1.2594</span> <span class="p">(</span> <span class="mf">22.2164</span><span class="p">)</span>    <span class="mf">0.0255</span> <span class="p">(</span>  <span class="mf">0.0049</span><span class="p">)</span>
   <span class="n">EBAY</span>    <span class="mf">0.0014</span> <span class="p">(</span>  <span class="mf">1.4326</span><span class="p">)</span>    <span class="mf">1.3441</span> <span class="p">(</span> <span class="mf">16.0732</span><span class="p">)</span>    <span class="mf">0.0376</span> <span class="p">(</span>  <span class="mf">0.0072</span><span class="p">)</span>
   <span class="n">GOOG</span>    <span class="mf">0.0041</span> <span class="p">(</span>  <span class="mf">2.8907</span><span class="p">)</span>    <span class="mf">0.6173</span> <span class="p">(</span>  <span class="mf">3.1100</span><span class="p">)</span>    <span class="mf">0.0337</span> <span class="p">(</span>  <span class="mf">0.0065</span><span class="p">)</span>
    <span class="n">HPQ</span>    <span class="mf">0.0001</span> <span class="p">(</span>  <span class="mf">0.1747</span><span class="p">)</span>    <span class="mf">1.3745</span> <span class="p">(</span> <span class="mf">24.2390</span><span class="p">)</span>    <span class="mf">0.0255</span> <span class="p">(</span>  <span class="mf">0.0049</span><span class="p">)</span>
    <span class="n">IBM</span>   <span class="o">-</span><span class="mf">0.0000</span> <span class="p">(</span>  <span class="mf">0.0312</span><span class="p">)</span>    <span class="mf">1.0807</span> <span class="p">(</span> <span class="mf">28.7576</span><span class="p">)</span>    <span class="mf">0.0169</span> <span class="p">(</span>  <span class="mf">0.0032</span><span class="p">)</span>
   <span class="n">INTC</span>    <span class="mf">0.0001</span> <span class="p">(</span>  <span class="mf">0.1608</span><span class="p">)</span>    <span class="mf">1.6002</span> <span class="p">(</span> <span class="mf">27.3684</span><span class="p">)</span>    <span class="mf">0.0263</span> <span class="p">(</span>  <span class="mf">0.0050</span><span class="p">)</span>
   <span class="n">MSFT</span>   <span class="o">-</span><span class="mf">0.0002</span> <span class="p">(</span>  <span class="mf">0.4871</span><span class="p">)</span>    <span class="mf">1.1765</span> <span class="p">(</span> <span class="mf">27.4554</span><span class="p">)</span>    <span class="mf">0.0193</span> <span class="p">(</span>  <span class="mf">0.0037</span><span class="p">)</span>
   <span class="n">ORCL</span>    <span class="mf">0.0000</span> <span class="p">(</span>  <span class="mf">0.0389</span><span class="p">)</span>    <span class="mf">1.5010</span> <span class="p">(</span> <span class="mf">21.1855</span><span class="p">)</span>    <span class="mf">0.0319</span> <span class="p">(</span>  <span class="mf">0.0061</span><span class="p">)</span>
   <span class="n">YHOO</span>    <span class="mf">0.0001</span> <span class="p">(</span>  <span class="mf">0.1282</span><span class="p">)</span>    <span class="mf">1.6543</span> <span class="p">(</span> <span class="mf">19.3838</span><span class="p">)</span>    <span class="mf">0.0384</span> <span class="p">(</span>  <span class="mf">0.0074</span><span class="p">)</span></code></pre></div><p data-pid="c6AnLnQp">尽管完整数据股票的结果相同，但是请注意，AMZN和GOOG（这两只有缺失值的股票）的beta估计值与分别为每个股票得出的估计值不同。由于AMZN的缺失值很少，因此估计差异很小。但是，对于GOOG，差异更加明显。</p><p data-pid="3EaGdhTf">现在，GOOG的beta估计值的t统计量的显着性水平为99.5％。但是请注意，beta估计值的t统计量是基于样本Hessian的标准误差，与Fisher信息矩阵相反，该误差源于缺失值导致估计值不确定性的增加。如果从更乐观的Fisher信息矩阵中获得t统计量，则GOOG的t统计量为8.25。因此，尽管存在缺失数据导致的不确定性增加，GOOG仍具有beta值的统计显着性估计。</p><p data-pid="LHc7m0tH">最后，请注意，GOOG的beta估算值为0.62-该值可能需要一些解释。尽管在此期间市场波动，价格出现了横向波动，但GOOG的价值却在不断升值。因此，它的相关性低于市场，这反过来意味着它的波动性低于beta值小于1的市场。</p><h3><b>参考文献</b></h3><p data-pid="R3lPatUF">[1] R. A. Jarrow, Finance Theory, Prentice-Hall, Inc., 1988.</p><p data-pid="ftFfbhrD">[2] J. Lintner, &#34;The Valuation of Risk Assets and the Selection of Risky Investments in Stocks,&#34; Review of Economics and Statistics, Vol. 14, 1965, pp. 13-37.</p><p data-pid="9DS93uTH">[3] W. F. Sharpe, &#34;Capital Asset Prices: A Theory of Market Equilibrium under Conditions of Risk,&#34; Journal of Finance, Vol. 19, 1964, pp. 425-442.</p><p data-pid="fAyuUHgO">[4] W. F. Sharpe, G. J. Alexander, and J. V. Bailey, Investments, 6th ed., Prentice-Hall, Inc., 1999.</p><h3><b>工具函数</b></h3><div class="highlight"><pre><code class="language-matlab"><span class="k"> function</span><span class="w"> </span><span class="nf">displaySummary</span><span class="p">(</span>regressionType, StartDate, EndDate, NumAssets, Assets, Alpha, StdAlpha, Beta, StdBeta, Sigma, StdSigma<span class="p">)</span><span class="w">
</span><span class="w"> </span><span class="n">fprintf</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="s">&#39;%s regression with daily total return data from %s to %s ...\n&#39;</span><span class="p">,</span> <span class="c">...</span>
     <span class="n">regressionType</span><span class="p">,</span> <span class="n">datestr</span><span class="p">(</span><span class="n">StartDate</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="n">datestr</span><span class="p">(</span><span class="n">EndDate</span><span class="p">,</span><span class="mi">1</span><span class="p">));</span>
 <span class="n">fprintf</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="s">&#39;  %4s %-20s %-20s %-20s\n&#39;</span><span class="p">,</span><span class="s">&#39; &#39;</span><span class="p">,</span><span class="s">&#39;Alpha&#39;</span><span class="p">,</span><span class="s">&#39;Beta&#39;</span><span class="p">,</span><span class="s">&#39;Sigma&#39;</span><span class="p">);</span>
 <span class="n">fprintf</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="s">&#39;  ---- -------------------- -------------------- --------------------\n&#39;</span><span class="p">);</span>
 ​
 <span class="k">for</span> <span class="nb">i</span> <span class="p">=</span> <span class="mi">1</span><span class="p">:</span><span class="n">NumAssets</span>
     <span class="n">fprintf</span><span class="p">(</span><span class="s">&#39;  %4s %9.4f (%8.4f) %9.4f (%8.4f) %9.4f (%8.4f)\n&#39;</span><span class="p">,</span> <span class="c">...</span>
         <span class="n">Assets</span><span class="p">{</span><span class="nb">i</span><span class="p">},</span><span class="n">Alpha</span><span class="p">(</span><span class="nb">i</span><span class="p">),</span><span class="nb">abs</span><span class="p">(</span><span class="n">Alpha</span><span class="p">(</span><span class="nb">i</span><span class="p">)</span><span class="o">/</span><span class="n">StdAlpha</span><span class="p">(</span><span class="nb">i</span><span class="p">)),</span> <span class="c">...</span>
         <span class="n">Beta</span><span class="p">(</span><span class="nb">i</span><span class="p">),</span><span class="nb">abs</span><span class="p">(</span><span class="n">Beta</span><span class="p">(</span><span class="nb">i</span><span class="p">)</span><span class="o">/</span><span class="n">StdBeta</span><span class="p">(</span><span class="nb">i</span><span class="p">)),</span><span class="n">Sigma</span><span class="p">(</span><span class="nb">i</span><span class="p">),</span><span class="n">StdSigma</span><span class="p">(</span><span class="nb">i</span><span class="p">));</span>
 <span class="k">end</span>
 ​
 <span class="k">end</span></code></pre></div><hr/><p data-pid="V_h3bQov">注：本文根据MATLAB官网内容修改而成。</p>
</p>
<p>
<br> ======================================================================
<br><strong> 我的测试结果及程序  </strong>
<br>下面是我测试的代码：
<pre>

 
</pre>
<br> <img src="myTestResult.png"   width="868px" height="478px">


</p>



                            </div>
                        </article>
                    </div>
                </div>
            </div>
          <footer id="colophon" role="contentinfo">
	<div id="site-generator">孙悟空 from 吉林大学自动化 @ sunwukong@sangkeji.com</div>
	<script src="../../../footer.js"></script>
          </footer>
        </div>
    </body>
</html>
