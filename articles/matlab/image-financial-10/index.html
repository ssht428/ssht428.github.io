<html>
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
        <title>MATLAB金融工具箱：10：投资组合优化案例</title>
        <link rel="stylesheet" type="text/css" media="all" href="../../../style.css">
    </head>
    <body class="post-template-default single single-post postid-14 single-format-standard logged-in admin-bar single-author singular two-column left-sidebar customize-support">
        <div id="page" class="hfeed">
            <div id="main">
                <div id="primary">
                    <div id="content" role="main">        
                        <article id="post-14" class="post-14 post type-post status-publish format-standard hentry category-18">
                            <header class="entry-header">
                                <h1 class="entry-title">MATLAB金融工具箱：10：投资组合优化案例</h1>
                            </header>
                            <div class="entry-content">
<br><a href="../../../index.html"> Home </a> 
<br>
<br>
<p>
<p data-first-child data-pid="lk4IPrIN">以下示例序列突出显示<code>Portfolio</code>了Financial Toolbox中对象的功能。具体而言，这些示例使用该<code><a href="https://www.mathworks.com/help/finance/portfolio.html" class=" wrap external" target="_blank" rel="nofollow noreferrer">Portfolio</a></code>对象来说明如何设置均方差投资组合优化问题，这些问题集中在双基金定理、交易成本和营业额约束的影响、如何获取最大化夏普比率的投资组合以及如何建立了两种流行的对冲基金策略-美元中性和130-30投资组合。</p><h3><b>设置数据</b></h3><p data-pid="ktVGHL9v">每个示例都具有用于计算30只“蓝筹”股票每月总回报的矩。尽管这些数据是从真实数据中得出的，但它们仅用于说明目的，并不代表特定资产或市场表现。该数据包含在文件<code>BlueChipStockMoments.mat</code>中，包括变量列表<code>AssetList</code>中的资产标识符变量，变量<code>AssetMean</code>和<code>AssetCovar</code>中的资产收益的均值和协方差，以及变量<code>CashMean</code>，<code>CashVar</code>，<code>MarketMean</code>，和<code>MarketVar</code>中的现金和市场回报的均值和方差。由于大多数分析都需要使用资产收益率的标准差作为风险，现金和市场方差的代表，因此将市场的方差转换为标准差。</p><div class="highlight"><pre><code class="language-matlab"> <span class="n">load</span> <span class="n">BlueChipStockMoments</span>
 ?
 <span class="n">mret</span> <span class="p">=</span> <span class="n">MarketMean</span><span class="p">;</span>
 <span class="n">mrsk</span> <span class="p">=</span> <span class="nb">sqrt</span><span class="p">(</span><span class="n">MarketVar</span><span class="p">);</span>
 <span class="n">cret</span> <span class="p">=</span> <span class="n">CashMean</span><span class="p">;</span>
 <span class="n">crsk</span> <span class="p">=</span> <span class="nb">sqrt</span><span class="p">(</span><span class="n">CashVar</span><span class="p">);</span></code></pre></div><h3><b>创建投资组合对象</b></h3><p data-pid="ooe6a9A3">首先用<code><a href="https://www.mathworks.com/help/finance/portfolio.html" class=" wrap external" target="_blank" rel="nofollow noreferrer">Portfolio</a></code>创建一个“标准” <code>Portfolio</code>对象，将资产列表、无风险利率以及资产返回时刻合并到该对象中。</p><div class="highlight"><pre><code class="language-matlab"> <span class="n">p</span> <span class="p">=</span> <span class="n">Portfolio</span><span class="p">(</span><span class="s">&#39;AssetList&#39;</span><span class="p">,</span><span class="n">AssetList</span><span class="p">,</span><span class="s">&#39;RiskFreeRate&#39;</span><span class="p">,</span><span class="n">CashMean</span><span class="p">);</span>
 <span class="n">p</span> <span class="p">=</span> <span class="n">setAssetMoments</span><span class="p">(</span><span class="n">p</span><span class="p">,</span><span class="n">AssetMean</span><span class="p">,</span><span class="n">AssetCovar</span><span class="p">);</span></code></pre></div><p data-pid="dkluIvs1">为了提供比较的基础，建立一个等权投资组合，并使其成为<code><a href="https://www.mathworks.com/help/finance/portfolio.html" class=" wrap external" target="_blank" rel="nofollow noreferrer">Portfolio</a></code>对象中的初始投资组合。请记住，稍后要建立的对冲投资组合将需要不同的初始投资组合。创建初始投资组合后，<code><a href="https://www.mathworks.com/help/finance/portfolio.estimateportmoments.html" class=" wrap external" target="_blank" rel="nofollow noreferrer">estimatePortMoments</a></code>函数将估算等权投资组合收益的均值和标准差。</p><div class="highlight"><pre><code class="language-matlab"> <span class="n">p</span> <span class="p">=</span> <span class="n">setInitPort</span><span class="p">(</span><span class="n">p</span><span class="p">,</span><span class="mi">1</span><span class="o">/</span><span class="n">p</span><span class="p">.</span><span class="n">NumAssets</span><span class="p">);</span>
 <span class="p">[</span><span class="n">ersk</span><span class="p">,</span><span class="n">eret</span><span class="p">]</span> <span class="p">=</span> <span class="n">estimatePortMoments</span><span class="p">(</span><span class="n">p</span><span class="p">,</span><span class="n">p</span><span class="p">.</span><span class="n">InitPort</span><span class="p">);</span></code></pre></div><p data-pid="RigyFtkM">专门的“帮助”函数<code>portfolioexamples_plot</code>（请参见<a href="https://www.mathworks.com/help/finance/examples/portfolio-optimization-examples-1.html%23portfolioexamples-17" class=" wrap external" target="_blank" rel="nofollow noreferrer">工具函数</a>部分）使得可以在此处绘制所有要开发的结果。第一张图显示了根据资产的均值和收益的标准偏差分配的资产。此外，等权重、市场和现金投资组合都绘制在同一图上。请注意，<code>portfolioexamples_plot</code>函数将每月总回报转换为年化总回报。</p><div class="highlight"><pre><code class="language-matlab"> <span class="n">clf</span><span class="p">;</span>
 <span class="n">portfolioexamples_plot</span><span class="p">(</span><span class="s">&#39;Asset Risks and Returns&#39;</span><span class="p">,</span> <span class="c">...</span>
     <span class="p">{</span><span class="s">&#39;scatter&#39;</span><span class="p">,</span> <span class="n">mrsk</span><span class="p">,</span> <span class="n">mret</span><span class="p">,</span> <span class="p">{</span><span class="s">&#39;Market&#39;</span><span class="p">}},</span> <span class="c">...</span>
     <span class="p">{</span><span class="s">&#39;scatter&#39;</span><span class="p">,</span> <span class="n">crsk</span><span class="p">,</span> <span class="n">cret</span><span class="p">,</span> <span class="p">{</span><span class="s">&#39;Cash&#39;</span><span class="p">}},</span> <span class="c">...</span>
     <span class="p">{</span><span class="s">&#39;scatter&#39;</span><span class="p">,</span> <span class="n">ersk</span><span class="p">,</span> <span class="n">eret</span><span class="p">,</span> <span class="p">{</span><span class="s">&#39;Equal&#39;</span><span class="p">}},</span> <span class="c">...</span>
     <span class="p">{</span><span class="s">&#39;scatter&#39;</span><span class="p">,</span> <span class="nb">sqrt</span><span class="p">(</span><span class="nb">diag</span><span class="p">(</span><span class="n">p</span><span class="p">.</span><span class="n">AssetCovar</span><span class="p">)),</span> <span class="n">p</span><span class="p">.</span><span class="n">AssetMean</span><span class="p">,</span> <span class="n">p</span><span class="p">.</span><span class="n">AssetList</span><span class="p">,</span> <span class="s">&#39;.r&#39;</span><span class="p">});</span></code></pre></div><br><img src="v2-14eeffec6c7d2e8b96912b3f2b6470c4_720w.jpg" ><h3><b>设置投资组合优化问题</b></h3><p data-pid="ii324ECM">使用需要完全投资的仅做多头投资组合（非负权重之和必须等于<code>1</code>）的<code><a href="https://www.mathworks.com/help/finance/portfolio.setdefaultconstraints.html" class=" wrap external" target="_blank" rel="nofollow noreferrer">setDefaultConstraints</a></code>函数来设置“标准”或默认的平均方差投资组合优化问题。给定初始问题，用函数<code><a href="https://www.mathworks.com/help/finance/portfolio.estimatefrontier.html" class=" wrap external" target="_blank" rel="nofollow noreferrer">estimateFrontier</a></code>和<code><a href="https://www.mathworks.com/help/finance/portfolio.estimateportmoments.html" class=" wrap external" target="_blank" rel="nofollow noreferrer">estimatePortMoments</a></code>估计函数的有效边界，其中<code><a href="https://www.mathworks.com/help/finance/portfolio.estimatefrontier.html" class=" wrap external" target="_blank" rel="nofollow noreferrer">estimateFrontier</a></code>估计有效的投资组合，<code><a href="https://www.mathworks.com/help/finance/portfolio.estimateportmoments.html" class=" wrap external" target="_blank" rel="nofollow noreferrer">estimatePortMoments</a></code>估计投资组合的风险和收益。下图覆盖到前一个图的有效边界上。</p><div class="highlight"><pre><code class="language-matlab"> <span class="n">p</span> <span class="p">=</span> <span class="n">setDefaultConstraints</span><span class="p">(</span><span class="n">p</span><span class="p">);</span>
 ?
 <span class="n">pwgt</span> <span class="p">=</span> <span class="n">estimateFrontier</span><span class="p">(</span><span class="n">p</span><span class="p">,</span><span class="mi">20</span><span class="p">);</span>
 <span class="p">[</span><span class="n">prsk</span><span class="p">,</span><span class="n">pret</span><span class="p">]</span> <span class="p">=</span> <span class="n">estimatePortMoments</span><span class="p">(</span><span class="n">p</span><span class="p">,</span><span class="n">pwgt</span><span class="p">);</span>
 ?
 <span class="c">% Plot efficient frontier</span>
 ?
 <span class="n">clf</span><span class="p">;</span>
 <span class="n">portfolioexamples_plot</span><span class="p">(</span><span class="s">&#39;Efficient Frontier&#39;</span><span class="p">,</span> <span class="c">...</span>
     <span class="p">{</span><span class="s">&#39;line&#39;</span><span class="p">,</span> <span class="n">prsk</span><span class="p">,</span> <span class="n">pret</span><span class="p">},</span> <span class="c">...</span>
     <span class="p">{</span><span class="s">&#39;scatter&#39;</span><span class="p">,</span> <span class="p">[</span><span class="n">mrsk</span><span class="p">,</span> <span class="n">crsk</span><span class="p">,</span> <span class="n">ersk</span><span class="p">],</span> <span class="p">[</span><span class="n">mret</span><span class="p">,</span> <span class="n">cret</span><span class="p">,</span> <span class="n">eret</span><span class="p">],</span> <span class="p">{</span><span class="s">&#39;Market&#39;</span><span class="p">,</span> <span class="s">&#39;Cash&#39;</span><span class="p">,</span> <span class="s">&#39;Equal&#39;</span><span class="p">}},</span> <span class="c">...</span>
     <span class="p">{</span><span class="s">&#39;scatter&#39;</span><span class="p">,</span> <span class="nb">sqrt</span><span class="p">(</span><span class="nb">diag</span><span class="p">(</span><span class="n">p</span><span class="p">.</span><span class="n">AssetCovar</span><span class="p">)),</span> <span class="n">p</span><span class="p">.</span><span class="n">AssetMean</span><span class="p">,</span> <span class="n">p</span><span class="p">.</span><span class="n">AssetList</span><span class="p">,</span> <span class="s">&#39;.r&#39;</span><span class="p">});</span></code></pre></div><br><img src="v2-fc4eb3035945237654a433115c54ba6c_720w.jpg" ><h3><b>为有效边界绘制切线</b></h3><p data-pid="rtHEVB_c">托宾的共同基金定理（Tobin，1958年）说，投资组合分配问题可以看作是在无风险资产和有风险资产之间进行分配的决策。在均值方差框架中，现金可以用作无风险资产的代理，而有效边界上的有效投资组合可以用作风险组合，这样现金和此投资组合之间的任何分配都可以控制有效边界上的所有其他投资组合。此投资组合称为“ <i>相切”投资组合，</i>因为它位于有效边界上的点，在该点上，源自无风险资产的切线与有效边界相接触。</p><p data-pid="S9vyyNXp">假设<code><a href="https://www.mathworks.com/help/finance/portfolio.html" class=" wrap external" target="_blank" rel="nofollow noreferrer">Portfolio</a></code>对象已经具有无风险利率，通过创建<code><a href="https://www.mathworks.com/help/finance/portfolio.html" class=" wrap external" target="_blank" rel="nofollow noreferrer">Portfolio</a></code>对象的副本来获得切线，该副本的预算限制允许在0％到100％之间分配现金。由于<code><a href="https://www.mathworks.com/help/finance/portfolio.html" class=" wrap external" target="_blank" rel="nofollow noreferrer">Portfolio</a></code>对象是值对象，因此可以通过将<code><a href="https://www.mathworks.com/help/finance/portfolio.html" class=" wrap external" target="_blank" rel="nofollow noreferrer">Portfolio</a></code>函数或“set”函数的输出分配给<code><a href="https://www.mathworks.com/help/finance/portfolio.html" class=" wrap external" target="_blank" rel="nofollow noreferrer">Portfolio</a></code>对象的新实例来创建副本。该图显示了有效边界，而Tobin的分配形成了有效边界的切线。</p><div class="highlight"><pre><code class="language-matlab"> <span class="n">q</span> <span class="p">=</span> <span class="n">setBudget</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
 ?
 <span class="n">qwgt</span> <span class="p">=</span> <span class="n">estimateFrontier</span><span class="p">(</span><span class="n">q</span><span class="p">,</span><span class="mi">20</span><span class="p">);</span>
 <span class="p">[</span><span class="n">qrsk</span><span class="p">,</span><span class="n">qret</span><span class="p">]</span> <span class="p">=</span> <span class="n">estimatePortMoments</span><span class="p">(</span><span class="n">q</span><span class="p">,</span><span class="n">qwgt</span><span class="p">);</span>
 ?
 <span class="c">% Plot efficient frontier with tangent line (0 to 1 cash)</span>
 ?
 <span class="n">clf</span><span class="p">;</span>
 <span class="n">portfolioexamples_plot</span><span class="p">(</span><span class="s">&#39;Efficient Frontier with Tangent Line&#39;</span><span class="p">,</span> <span class="c">...</span>
     <span class="p">{</span><span class="s">&#39;line&#39;</span><span class="p">,</span> <span class="n">prsk</span><span class="p">,</span> <span class="n">pret</span><span class="p">},</span> <span class="c">...</span>
     <span class="p">{</span><span class="s">&#39;line&#39;</span><span class="p">,</span> <span class="n">qrsk</span><span class="p">,</span> <span class="n">qret</span><span class="p">,</span> <span class="p">[],</span> <span class="p">[],</span> <span class="mi">1</span><span class="p">},</span> <span class="c">...</span>
     <span class="p">{</span><span class="s">&#39;scatter&#39;</span><span class="p">,</span> <span class="p">[</span><span class="n">mrsk</span><span class="p">,</span> <span class="n">crsk</span><span class="p">,</span> <span class="n">ersk</span><span class="p">],</span> <span class="p">[</span><span class="n">mret</span><span class="p">,</span> <span class="n">cret</span><span class="p">,</span> <span class="n">eret</span><span class="p">],</span> <span class="p">{</span><span class="s">&#39;Market&#39;</span><span class="p">,</span> <span class="s">&#39;Cash&#39;</span><span class="p">,</span> <span class="s">&#39;Equal&#39;</span><span class="p">}},</span> <span class="c">...</span>
     <span class="p">{</span><span class="s">&#39;scatter&#39;</span><span class="p">,</span> <span class="nb">sqrt</span><span class="p">(</span><span class="nb">diag</span><span class="p">(</span><span class="n">p</span><span class="p">.</span><span class="n">AssetCovar</span><span class="p">)),</span> <span class="n">p</span><span class="p">.</span><span class="n">AssetMean</span><span class="p">,</span> <span class="n">p</span><span class="p">.</span><span class="n">AssetList</span><span class="p">,</span> <span class="s">&#39;.r&#39;</span><span class="p">});</span></code></pre></div><br><img src="v2-2efddf6c5c9f24f7f1570873b4f01fd8_720w.jpg" ><p data-pid="0Z43b4mU">请注意，现金实际上具有较小的风险，因此切线不会穿过现金资产。</p><h3><b>获取风险和回报范围</b></h3><p data-pid="Jv6NCP8e">为了获得风险目标值或收益目标值的有效投资组合，有必要获得有效边界上所有投资组合的风险和收益范围。这是通过<code><a href="https://www.mathworks.com/help/finance/portfolio.estimatefrontierlimits.html" class=" wrap external" target="_blank" rel="nofollow noreferrer">estimateFrontierLimits</a></code>函数完成的。</p><div class="highlight"><pre><code class="language-matlab"> <span class="p">[</span><span class="n">rsk</span><span class="p">,</span><span class="n">ret</span><span class="p">]</span> <span class="p">=</span> <span class="n">estimatePortMoments</span><span class="p">(</span><span class="n">p</span><span class="p">,</span><span class="n">estimateFrontierLimits</span><span class="p">(</span><span class="n">p</span><span class="p">));</span>
 ?
 <span class="n">display</span><span class="p">(</span><span class="n">rsk</span><span class="p">);</span>
 <span class="n">rsk</span> <span class="p">=</span> <span class="mi">2</span>×<span class="mi">1</span>
 ?
     <span class="mf">0.0348</span>
     <span class="mf">0.0903</span>
 <span class="n">display</span><span class="p">(</span><span class="n">ret</span><span class="p">);</span>
 <span class="n">ret</span> <span class="p">=</span> <span class="mi">2</span>×<span class="mi">1</span>
 ?
     <span class="mf">0.0094</span>
     <span class="mf">0.0179</span></code></pre></div><p data-pid="P5GI6fP-">每月投资组合收益的范围在0.9％至1.8％之间，投资组合风险的范围在3.5％至9.0％之间。以年度计算，投资组合收益的范围为11.2％至21.5％，投资组合风险的范围为12.1％至31.3％。</p><h3><b>寻找具有目标回报率和目标风险的投资组合</b></h3><p data-pid="Bq1fh6vA">考虑到风险和回报的范围内，可以使用以下函数找到具有目标值回报和目标风险有效前沿的具体投资组合：<code><a href="https://www.mathworks.com/help/finance/portfolio.estimatefrontierbyreturn.html" class=" wrap external" target="_blank" rel="nofollow noreferrer">estimateFrontierByReturn</a></code>和<code><a href="https://www.mathworks.com/help/finance/portfolio.estimatefrontierbyrisk.html" class=" wrap external" target="_blank" rel="nofollow noreferrer">estimateFrontierByRisk</a></code>。</p><div class="highlight"><pre><code class="language-matlab"> <span class="n">TargetReturn</span> <span class="p">=</span> <span class="mf">0.20</span><span class="p">;</span>            <span class="c">% Input target annualized return and risk here</span>
 <span class="n">TargetRisk</span> <span class="p">=</span> <span class="mf">0.15</span><span class="p">;</span>
 ?
 <span class="c">% Obtain portfolios with targeted return and risk</span>
 ?
 <span class="n">awgt</span> <span class="p">=</span> <span class="n">estimateFrontierByReturn</span><span class="p">(</span><span class="n">p</span><span class="p">,</span><span class="n">TargetReturn</span><span class="o">/</span><span class="mi">12</span><span class="p">);</span>
 <span class="p">[</span><span class="n">arsk</span><span class="p">,</span><span class="n">aret</span><span class="p">]</span> <span class="p">=</span> <span class="n">estimatePortMoments</span><span class="p">(</span><span class="n">p</span><span class="p">,</span><span class="n">awgt</span><span class="p">);</span>
 ?
 <span class="n">bwgt</span> <span class="p">=</span> <span class="n">estimateFrontierByRisk</span><span class="p">(</span><span class="n">p</span><span class="p">,</span><span class="n">TargetRisk</span><span class="o">/</span><span class="nb">sqrt</span><span class="p">(</span><span class="mi">12</span><span class="p">));</span>
 <span class="p">[</span><span class="n">brsk</span><span class="p">,</span><span class="n">bret</span><span class="p">]</span> <span class="p">=</span> <span class="n">estimatePortMoments</span><span class="p">(</span><span class="n">p</span><span class="p">,</span><span class="n">bwgt</span><span class="p">);</span>
 ?
 <span class="c">% Plot efficient frontier with targeted portfolios</span>
 ?
 <span class="n">clf</span><span class="p">;</span>
 <span class="n">portfolioexamples_plot</span><span class="p">(</span><span class="s">&#39;Efficient Frontier with Targeted Portfolios&#39;</span><span class="p">,</span> <span class="c">...</span>
     <span class="p">{</span><span class="s">&#39;line&#39;</span><span class="p">,</span> <span class="n">prsk</span><span class="p">,</span> <span class="n">pret</span><span class="p">},</span> <span class="c">...</span>
     <span class="p">{</span><span class="s">&#39;scatter&#39;</span><span class="p">,</span> <span class="p">[</span><span class="n">mrsk</span><span class="p">,</span> <span class="n">crsk</span><span class="p">,</span> <span class="n">ersk</span><span class="p">],</span> <span class="p">[</span><span class="n">mret</span><span class="p">,</span> <span class="n">cret</span><span class="p">,</span> <span class="n">eret</span><span class="p">],</span> <span class="p">{</span><span class="s">&#39;Market&#39;</span><span class="p">,</span> <span class="s">&#39;Cash&#39;</span><span class="p">,</span> <span class="s">&#39;Equal&#39;</span><span class="p">}},</span> <span class="c">...</span>
     <span class="p">{</span><span class="s">&#39;scatter&#39;</span><span class="p">,</span> <span class="n">arsk</span><span class="p">,</span> <span class="n">aret</span><span class="p">,</span> <span class="p">{</span><span class="n">sprintf</span><span class="p">(</span><span class="s">&#39;%g%% Return&#39;</span><span class="p">,</span><span class="mi">100</span><span class="o">*</span><span class="n">TargetReturn</span><span class="p">)}},</span> <span class="c">...</span>
     <span class="p">{</span><span class="s">&#39;scatter&#39;</span><span class="p">,</span> <span class="n">brsk</span><span class="p">,</span> <span class="n">bret</span><span class="p">,</span> <span class="p">{</span><span class="n">sprintf</span><span class="p">(</span><span class="s">&#39;%g%% Risk&#39;</span><span class="p">,</span><span class="mi">100</span><span class="o">*</span><span class="n">TargetRisk</span><span class="p">)}},</span> <span class="c">...</span>
     <span class="p">{</span><span class="s">&#39;scatter&#39;</span><span class="p">,</span> <span class="nb">sqrt</span><span class="p">(</span><span class="nb">diag</span><span class="p">(</span><span class="n">p</span><span class="p">.</span><span class="n">AssetCovar</span><span class="p">)),</span> <span class="n">p</span><span class="p">.</span><span class="n">AssetMean</span><span class="p">,</span> <span class="n">p</span><span class="p">.</span><span class="n">AssetList</span><span class="p">,</span> <span class="s">&#39;.r&#39;</span><span class="p">});</span></code></pre></div><br><img src="v2-7f8e5d699d66c59a848c43a801ec4f83_720w.jpg" ><p data-pid="xm6R220g">要查看这些目标投资组合的外观，使用<code><a href="https://www.mathworks.com/help/stats/dataset.html" class=" wrap external" target="_blank" rel="nofollow noreferrer">dataset</a></code>对象设置包含投资组合权重和资产名称（从<code><a href="https://www.mathworks.com/help/finance/portfolio.html" class=" wrap external" target="_blank" rel="nofollow noreferrer">Portfolio</a></code>对象获得）的记录本。</p><div class="highlight"><pre><code class="language-matlab"> <span class="n">aBlotter</span> <span class="p">=</span> <span class="n">dataset</span><span class="p">({</span><span class="mi">100</span><span class="o">*</span><span class="n">awgt</span><span class="p">(</span><span class="n">awgt</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">),</span><span class="s">&#39;Weight&#39;</span><span class="p">},</span> <span class="s">&#39;obsnames&#39;</span><span class="p">,</span> <span class="n">p</span><span class="p">.</span><span class="n">AssetList</span><span class="p">(</span><span class="n">awgt</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">));</span>
 ?
 <span class="n">displayPortfolio</span><span class="p">(</span><span class="n">sprintf</span><span class="p">(</span><span class="s">&#39;Portfolio with %g%% Target Return&#39;</span><span class="p">,</span> <span class="mi">100</span><span class="o">*</span><span class="n">TargetReturn</span><span class="p">),</span> <span class="n">aBlotter</span><span class="p">,</span> <span class="n">false</span><span class="p">);</span>
 <span class="n">Portfolio</span> <span class="n">with</span> <span class="mi">20</span><span class="c">% Target Return</span>
             <span class="n">Weight</span> 
     <span class="n">CAT</span>      <span class="mf">1.1445</span>
     <span class="n">INTC</span>    <span class="mf">0.17452</span>
     <span class="n">MO</span>       <span class="mf">9.6521</span>
     <span class="n">MSFT</span>    <span class="mf">0.85862</span>
     <span class="n">UTX</span>      <span class="mf">56.918</span>
     <span class="n">WMT</span>      <span class="mf">31.253</span>
 <span class="n">bBlotter</span> <span class="p">=</span> <span class="n">dataset</span><span class="p">({</span><span class="mi">100</span><span class="o">*</span><span class="n">bwgt</span><span class="p">(</span><span class="n">bwgt</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">),</span><span class="s">&#39;Weight&#39;</span><span class="p">},</span> <span class="s">&#39;obsnames&#39;</span><span class="p">,</span> <span class="n">p</span><span class="p">.</span><span class="n">AssetList</span><span class="p">(</span><span class="n">bwgt</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">));</span>
 ?
 <span class="n">displayPortfolio</span><span class="p">(</span><span class="n">sprintf</span><span class="p">(</span><span class="s">&#39;Portfolio with %g%% Target Risk&#39;</span><span class="p">,</span> <span class="mi">100</span><span class="o">*</span><span class="n">TargetRisk</span><span class="p">),</span> <span class="n">bBlotter</span><span class="p">,</span> <span class="n">false</span><span class="p">);</span>
 <span class="n">Portfolio</span> <span class="n">with</span> <span class="mi">15</span><span class="c">% Target Risk</span>
             <span class="n">Weight</span>    
     <span class="n">BA</span>      <span class="mf">3.1996e-22</span>
     <span class="n">C</span>       <span class="mf">1.8304e-22</span>
     <span class="n">DIS</span>     <span class="mf">1.6394e-20</span>
     <span class="n">GE</span>      <span class="mf">4.2564e-21</span>
     <span class="n">HD</span>      <span class="mf">3.9772e-21</span>
     <span class="n">INTC</span>        <span class="mf">2.2585</span>
     <span class="n">JNJ</span>         <span class="mf">9.2162</span>
     <span class="n">JPM</span>     <span class="mf">2.2817e-21</span>
     <span class="n">KO</span>      <span class="mf">1.6585e-21</span>
     <span class="n">MMM</span>         <span class="mf">16.603</span>
     <span class="n">MO</span>          <span class="mf">15.388</span>
     <span class="n">MSFT</span>        <span class="mf">4.4467</span>
     <span class="n">PG</span>           <span class="mf">4.086</span>
     <span class="n">UTX</span>         <span class="mf">10.281</span>
     <span class="n">WMT</span>         <span class="mf">25.031</span>
     <span class="n">XOM</span>          <span class="mf">12.69</span></code></pre></div><h3><b>交易成本</b></h3><p data-pid="CK7qCqj9"><code><a href="https://www.mathworks.com/help/finance/portfolio.html" class=" wrap external" target="_blank" rel="nofollow noreferrer">Portfolio</a></code>对象使得将交易成本作为优化问题的一部分进行考虑成为可能。尽管可以为每种资产设置单独的成本，但可以使用<code>Portfolio</code>对象函数的标量扩展功能为所有资产设置统一的交易成本，并将有效边界与总投资收益与净投资收益进行比较。</p><div class="highlight"><pre><code class="language-matlab"> <span class="n">BuyCost</span> <span class="p">=</span> <span class="mf">0.0020</span><span class="p">;</span>
 <span class="n">SellCost</span> <span class="p">=</span> <span class="mf">0.0020</span><span class="p">;</span>
 ?
 <span class="n">q</span> <span class="p">=</span> <span class="n">setCosts</span><span class="p">(</span><span class="n">p</span><span class="p">,</span><span class="n">BuyCost</span><span class="p">,</span><span class="n">SellCost</span><span class="p">);</span>
 ?
 <span class="n">qwgt</span> <span class="p">=</span> <span class="n">estimateFrontier</span><span class="p">(</span><span class="n">q</span><span class="p">,</span><span class="mi">20</span><span class="p">);</span>
 <span class="p">[</span><span class="n">qrsk</span><span class="p">,</span><span class="n">qret</span><span class="p">]</span> <span class="p">=</span> <span class="n">estimatePortMoments</span><span class="p">(</span><span class="n">q</span><span class="p">,</span><span class="n">qwgt</span><span class="p">);</span>
 ?
 <span class="c">% Plot efficient frontiers with gross and net returns</span>
 ?
 <span class="n">clf</span><span class="p">;</span>
 <span class="n">portfolioexamples_plot</span><span class="p">(</span><span class="s">&#39;Efficient Frontier with and without Transaction Costs&#39;</span><span class="p">,</span> <span class="c">...</span>
     <span class="p">{</span><span class="s">&#39;line&#39;</span><span class="p">,</span> <span class="n">prsk</span><span class="p">,</span> <span class="n">pret</span><span class="p">,</span> <span class="p">{</span><span class="s">&#39;Gross&#39;</span><span class="p">},</span> <span class="s">&#39;:b&#39;</span><span class="p">},</span> <span class="c">...</span>
     <span class="p">{</span><span class="s">&#39;line&#39;</span><span class="p">,</span> <span class="n">qrsk</span><span class="p">,</span> <span class="n">qret</span><span class="p">,</span> <span class="p">{</span><span class="s">&#39;Net&#39;</span><span class="p">}},</span> <span class="c">...</span>
     <span class="p">{</span><span class="s">&#39;scatter&#39;</span><span class="p">,</span> <span class="p">[</span><span class="n">mrsk</span><span class="p">,</span> <span class="n">crsk</span><span class="p">,</span> <span class="n">ersk</span><span class="p">],</span> <span class="p">[</span><span class="n">mret</span><span class="p">,</span> <span class="n">cret</span><span class="p">,</span> <span class="n">eret</span><span class="p">],</span> <span class="p">{</span><span class="s">&#39;Market&#39;</span><span class="p">,</span> <span class="s">&#39;Cash&#39;</span><span class="p">,</span> <span class="s">&#39;Equal&#39;</span><span class="p">}},</span> <span class="c">...</span>
     <span class="p">{</span><span class="s">&#39;scatter&#39;</span><span class="p">,</span> <span class="nb">sqrt</span><span class="p">(</span><span class="nb">diag</span><span class="p">(</span><span class="n">p</span><span class="p">.</span><span class="n">AssetCovar</span><span class="p">)),</span> <span class="n">p</span><span class="p">.</span><span class="n">AssetMean</span><span class="p">,</span> <span class="n">p</span><span class="p">.</span><span class="n">AssetList</span><span class="p">,</span> <span class="s">&#39;.r&#39;</span><span class="p">});</span></code></pre></div><br><img src="v2-420afba4040b94910dce8a554212dc6e_720w.jpg" ><h3><b>周转限制</b></h3><p data-pid="LajgjGY8">除交易成本外，<code><a href="https://www.mathworks.com/help/finance/portfolio.html" class=" wrap external" target="_blank" rel="nofollow noreferrer">Portfolio</a></code>对象还可以处理营业额限制。下面的示例说明，营业额约束会在可能限制交易的初始投资组合附近产生有效边界。此外，引入营业额约束通常意味着可能需要多次交易才能从初始投资组合转移到不受约束的有效边界。因此，营业额约束引入了一种时间多样化的形式，可以使交易分散在多个时间段内。在此示例中，请注意，<code><a href="https://www.mathworks.com/help/finance/portfolio.estimatefrontier.html" class=" wrap external" target="_blank" rel="nofollow noreferrer">estimateFrontier</a></code>函数的购买和销售总和确认已满足营业额约束。</p><div class="highlight"><pre><code class="language-matlab"> <span class="n">BuyCost</span> <span class="p">=</span> <span class="mf">0.0020</span><span class="p">;</span>
 <span class="n">SellCost</span> <span class="p">=</span> <span class="mf">0.0020</span><span class="p">;</span>
 <span class="n">Turnover</span> <span class="p">=</span> <span class="mf">0.2</span><span class="p">;</span>
 ?
 <span class="n">q</span> <span class="p">=</span> <span class="n">setCosts</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">BuyCost</span><span class="p">,</span><span class="n">SellCost</span><span class="p">);</span>
 <span class="n">q</span> <span class="p">=</span> <span class="n">setTurnover</span><span class="p">(</span><span class="n">q</span><span class="p">,</span><span class="n">Turnover</span><span class="p">);</span>
 ?
 <span class="p">[</span><span class="n">qwgt</span><span class="p">,</span><span class="n">qbuy</span><span class="p">,</span><span class="n">qsell</span><span class="p">]</span> <span class="p">=</span> <span class="n">estimateFrontier</span><span class="p">(</span><span class="n">q</span><span class="p">,</span><span class="mi">20</span><span class="p">);</span>
 <span class="p">[</span><span class="n">qrsk</span><span class="p">,</span><span class="n">qret</span><span class="p">]</span> <span class="p">=</span> <span class="n">estimatePortMoments</span><span class="p">(</span><span class="n">q</span><span class="p">,</span><span class="n">qwgt</span><span class="p">);</span>
 ?
 <span class="c">% Plot efficient frontier with turnover constraint</span>
 ?
 <span class="n">clf</span><span class="p">;</span>
 <span class="n">portfolioexamples_plot</span><span class="p">(</span><span class="s">&#39;Efficient Frontier with Turnover Constraint&#39;</span><span class="p">,</span> <span class="c">...</span>
     <span class="p">{</span><span class="s">&#39;line&#39;</span><span class="p">,</span> <span class="n">prsk</span><span class="p">,</span> <span class="n">pret</span><span class="p">,</span> <span class="p">{</span><span class="s">&#39;Unconstrained&#39;</span><span class="p">},</span> <span class="s">&#39;:b&#39;</span><span class="p">},</span> <span class="c">...</span>
     <span class="p">{</span><span class="s">&#39;line&#39;</span><span class="p">,</span> <span class="n">qrsk</span><span class="p">,</span> <span class="n">qret</span><span class="p">,</span> <span class="p">{</span><span class="n">sprintf</span><span class="p">(</span><span class="s">&#39;%g%% Turnover&#39;</span><span class="p">,</span> <span class="mi">100</span><span class="o">*</span><span class="n">Turnover</span><span class="p">)}},</span> <span class="c">...</span>
     <span class="p">{</span><span class="s">&#39;scatter&#39;</span><span class="p">,</span> <span class="p">[</span><span class="n">mrsk</span><span class="p">,</span> <span class="n">crsk</span><span class="p">,</span> <span class="n">ersk</span><span class="p">],</span> <span class="p">[</span><span class="n">mret</span><span class="p">,</span> <span class="n">cret</span><span class="p">,</span> <span class="n">eret</span><span class="p">],</span> <span class="p">{</span><span class="s">&#39;Market&#39;</span><span class="p">,</span> <span class="s">&#39;Cash&#39;</span><span class="p">,</span> <span class="s">&#39;Equal&#39;</span><span class="p">}},</span> <span class="c">...</span>
     <span class="p">{</span><span class="s">&#39;scatter&#39;</span><span class="p">,</span> <span class="nb">sqrt</span><span class="p">(</span><span class="nb">diag</span><span class="p">(</span><span class="n">p</span><span class="p">.</span><span class="n">AssetCovar</span><span class="p">)),</span> <span class="n">p</span><span class="p">.</span><span class="n">AssetMean</span><span class="p">,</span> <span class="n">p</span><span class="p">.</span><span class="n">AssetList</span><span class="p">,</span> <span class="s">&#39;.r&#39;</span><span class="p">});</span></code></pre></div><br><img src="v2-67e1e61d971b279188d251b5642d5135_720w.jpg" ><div class="highlight"><pre><code class="language-matlab"> <span class="n">displaySumOfTransactions</span><span class="p">(</span><span class="n">Turnover</span><span class="p">,</span> <span class="n">qbuy</span><span class="p">,</span> <span class="n">qsell</span><span class="p">)</span>
 <span class="n">Sum</span> <span class="n">of</span> <span class="n">Purchases</span> <span class="n">by</span> <span class="n">Portfolio</span> <span class="n">along</span> <span class="n">Efficient</span> <span class="n">Frontier</span> <span class="p">(</span><span class="n">Max</span><span class="p">.</span> <span class="n">Turnover</span> <span class="mi">20</span><span class="c">%)</span>
 <span class="mf">20.0000</span> <span class="mf">20.0000</span> <span class="mf">20.0000</span> <span class="mf">20.0000</span> <span class="mf">20.0000</span> <span class="mf">20.0000</span> <span class="mf">20.0000</span> <span class="mf">20.0000</span> <span class="mf">20.0000</span> <span class="mf">20.0000</span> <span class="mf">20.0000</span> <span class="mf">20.0000</span> <span class="mf">20.0000</span> <span class="mf">20.0000</span> <span class="mf">20.0000</span> <span class="mf">20.0000</span> <span class="mf">20.0000</span> <span class="mf">20.0000</span> <span class="mf">20.0000</span> <span class="mf">20.0000</span> 
 <span class="n">Sum</span> <span class="n">of</span> <span class="n">Sales</span> <span class="n">by</span> <span class="n">Portfolio</span> <span class="n">along</span> <span class="n">Efficient</span> <span class="n">Frontier</span> <span class="p">(</span><span class="n">Max</span><span class="p">.</span> <span class="n">Turnover</span> <span class="mi">20</span><span class="c">%)</span>
 <span class="mf">20.0000</span> <span class="mf">20.0000</span> <span class="mf">20.0000</span> <span class="mf">20.0000</span> <span class="mf">20.0000</span> <span class="mf">20.0000</span> <span class="mf">20.0000</span> <span class="mf">20.0000</span> <span class="mf">20.0000</span> <span class="mf">20.0000</span> <span class="mf">20.0000</span> <span class="mf">20.0000</span> <span class="mf">20.0000</span> <span class="mf">20.0000</span> <span class="mf">20.0000</span> <span class="mf">20.0000</span> <span class="mf">20.0000</span> <span class="mf">20.0000</span> <span class="mf">20.0000</span> <span class="mf">20.0000</span> </code></pre></div><h3><b>误差跟踪约束</b></h3><p data-pid="FMbtnaub"><code><a href="https://www.mathworks.com/help/finance/portfolio.html" class=" wrap external" target="_blank" rel="nofollow noreferrer">Portfolio</a></code>对象可以处理误差跟踪约束，其中跟踪误差是投资组合与跟踪投资组合相比的相对风险。在此示例中，九个资产的子集合构成了一个权重相等的跟踪投资组合。目标是找到跟踪误差在此跟踪投资组合的5％以内的有效投资组合。</p><div class="highlight"><pre><code class="language-matlab"> <span class="n">ii</span> <span class="p">=</span> <span class="p">[</span><span class="mi">15</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">21</span><span class="p">,</span> <span class="mi">23</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span> <span class="mi">27</span><span class="p">,</span> <span class="mi">29</span><span class="p">,</span> <span class="mi">30</span><span class="p">];</span>  <span class="c">% Indexes of assets to include in tracking portfolio</span>
 ?
 <span class="n">TrackingError</span> <span class="p">=</span> <span class="mf">0.05</span><span class="o">/</span><span class="nb">sqrt</span><span class="p">(</span><span class="mi">12</span><span class="p">);</span>
 <span class="n">TrackingPort</span> <span class="p">=</span> <span class="nb">zeros</span><span class="p">(</span><span class="mi">30</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
 <span class="n">TrackingPort</span><span class="p">(</span><span class="n">ii</span><span class="p">)</span> <span class="p">=</span> <span class="mi">1</span><span class="p">;</span>
 <span class="n">TrackingPort</span> <span class="p">=</span> <span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">sum</span><span class="p">(</span><span class="n">TrackingPort</span><span class="p">))</span><span class="o">*</span><span class="n">TrackingPort</span><span class="p">;</span>
 ?
 <span class="n">q</span> <span class="p">=</span> <span class="n">setTrackingError</span><span class="p">(</span><span class="n">p</span><span class="p">,</span><span class="n">TrackingError</span><span class="p">,</span><span class="n">TrackingPort</span><span class="p">);</span>
 ?
 <span class="n">qwgt</span> <span class="p">=</span> <span class="n">estimateFrontier</span><span class="p">(</span><span class="n">q</span><span class="p">,</span><span class="mi">20</span><span class="p">);</span>
 <span class="p">[</span><span class="n">qrsk</span><span class="p">,</span><span class="n">qret</span><span class="p">]</span> <span class="p">=</span> <span class="n">estimatePortMoments</span><span class="p">(</span><span class="n">q</span><span class="p">,</span><span class="n">qwgt</span><span class="p">);</span>
 ?
 <span class="p">[</span><span class="n">trsk</span><span class="p">,</span><span class="n">tret</span><span class="p">]</span> <span class="p">=</span> <span class="n">estimatePortMoments</span><span class="p">(</span><span class="n">q</span><span class="p">,</span><span class="n">TrackingPort</span><span class="p">);</span>
 ?
 <span class="c">% Plot efficient frontier with tracking-error constraint</span>
 ?
 <span class="n">clf</span><span class="p">;</span>
 <span class="n">portfolioexamples_plot</span><span class="p">(</span><span class="s">&#39;Efficient Frontier with 5% Tracking-Error Constraint&#39;</span><span class="p">,</span> <span class="c">...</span>
     <span class="p">{</span><span class="s">&#39;line&#39;</span><span class="p">,</span> <span class="n">prsk</span><span class="p">,</span> <span class="n">pret</span><span class="p">,</span> <span class="p">{</span><span class="s">&#39;Unconstrained&#39;</span><span class="p">},</span> <span class="s">&#39;:b&#39;</span><span class="p">},</span> <span class="c">...</span>
     <span class="p">{</span><span class="s">&#39;line&#39;</span><span class="p">,</span> <span class="n">qrsk</span><span class="p">,</span> <span class="n">qret</span><span class="p">,</span> <span class="p">{</span><span class="s">&#39;Tracking&#39;</span><span class="p">}},</span> <span class="c">...</span>
     <span class="p">{</span><span class="s">&#39;scatter&#39;</span><span class="p">,</span> <span class="p">[</span><span class="n">mrsk</span><span class="p">,</span> <span class="n">crsk</span><span class="p">],</span> <span class="p">[</span><span class="n">mret</span><span class="p">,</span> <span class="n">cret</span><span class="p">],</span> <span class="p">{</span><span class="s">&#39;Market&#39;</span><span class="p">,</span> <span class="s">&#39;Cash&#39;</span><span class="p">}},</span> <span class="c">...</span>
     <span class="p">{</span><span class="s">&#39;scatter&#39;</span><span class="p">,</span> <span class="n">trsk</span><span class="p">,</span> <span class="n">tret</span><span class="p">,</span> <span class="p">{</span><span class="s">&#39;Tracking&#39;</span><span class="p">},</span> <span class="s">&#39;r&#39;</span><span class="p">});</span></code></pre></div><br><img src="v2-58a5956789a83ee537e9b8ecac15d2c8_720w.jpg" ><h3><b>组合的周转和误差跟踪约束</b></h3><p data-pid="GUMOMm-4">此示例说明了组合约束可能发生的交互。在这种情况下，必须同时满足相对于初始等权资产投资组合的周转约束和相对于追踪投资组合的跟踪误差约束。周转额约束条件的最大值为周转额的30％，跟踪误差约束条件的误差最大值的5％。请注意，从初始投资组合到跟踪投资组合的周转额是70％，因此，周转额上限为30％意味着有效边界将位于初始投资组合和跟踪投资组合之间。</p><div class="highlight"><pre><code class="language-matlab"> <span class="n">Turnover</span> <span class="p">=</span> <span class="mf">0.3</span><span class="p">;</span>
 <span class="n">InitPort</span> <span class="p">=</span> <span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">q</span><span class="p">.</span><span class="n">NumAssets</span><span class="p">)</span><span class="o">*</span><span class="nb">ones</span><span class="p">(</span><span class="n">q</span><span class="p">.</span><span class="n">NumAssets</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
 ?
 <span class="n">ii</span> <span class="p">=</span> <span class="p">[</span><span class="mi">15</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">21</span><span class="p">,</span> <span class="mi">23</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span> <span class="mi">27</span><span class="p">,</span> <span class="mi">29</span><span class="p">,</span> <span class="mi">30</span><span class="p">];</span>  <span class="c">% Indexes of assets to include in tracking portfolio</span>
 ?
 <span class="n">TrackingError</span> <span class="p">=</span> <span class="mf">0.05</span><span class="o">/</span><span class="nb">sqrt</span><span class="p">(</span><span class="mi">12</span><span class="p">);</span>
 <span class="n">TrackingPort</span> <span class="p">=</span> <span class="nb">zeros</span><span class="p">(</span><span class="mi">30</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
 <span class="n">TrackingPort</span><span class="p">(</span><span class="n">ii</span><span class="p">)</span> <span class="p">=</span> <span class="mi">1</span><span class="p">;</span>
 <span class="n">TrackingPort</span> <span class="p">=</span> <span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">sum</span><span class="p">(</span><span class="n">TrackingPort</span><span class="p">))</span><span class="o">*</span><span class="n">TrackingPort</span><span class="p">;</span>
 ?
 <span class="n">q</span> <span class="p">=</span> <span class="n">setTurnover</span><span class="p">(</span><span class="n">q</span><span class="p">,</span><span class="n">Turnover</span><span class="p">,</span><span class="n">InitPort</span><span class="p">);</span>
 ?
 <span class="n">qwgt</span> <span class="p">=</span> <span class="n">estimateFrontier</span><span class="p">(</span><span class="n">q</span><span class="p">,</span><span class="mi">20</span><span class="p">);</span>
 <span class="p">[</span><span class="n">qrsk</span><span class="p">,</span><span class="n">qret</span><span class="p">]</span> <span class="p">=</span> <span class="n">estimatePortMoments</span><span class="p">(</span><span class="n">q</span><span class="p">,</span><span class="n">qwgt</span><span class="p">);</span>
 ?
 <span class="p">[</span><span class="n">trsk</span><span class="p">,</span><span class="n">tret</span><span class="p">]</span> <span class="p">=</span> <span class="n">estimatePortMoments</span><span class="p">(</span><span class="n">q</span><span class="p">,</span><span class="n">TrackingPort</span><span class="p">);</span>
 <span class="p">[</span><span class="n">ersk</span><span class="p">,</span><span class="n">eret</span><span class="p">]</span> <span class="p">=</span> <span class="n">estimatePortMoments</span><span class="p">(</span><span class="n">q</span><span class="p">,</span><span class="n">InitPort</span><span class="p">);</span>
 ?
 <span class="c">% Plot efficient frontier with combined turnover and tracking-error constraint</span>
 ?
 <span class="n">clf</span><span class="p">;</span>
 <span class="n">portfolioexamples_plot</span><span class="p">(</span><span class="s">&#39;Efficient Frontier with Turnover and Tracking-Error Constraint&#39;</span><span class="p">,</span> <span class="c">...</span>
     <span class="p">{</span><span class="s">&#39;line&#39;</span><span class="p">,</span> <span class="n">prsk</span><span class="p">,</span> <span class="n">pret</span><span class="p">,</span> <span class="p">{</span><span class="s">&#39;Unconstrained&#39;</span><span class="p">},</span> <span class="s">&#39;:b&#39;</span><span class="p">},</span> <span class="c">...</span>
     <span class="p">{</span><span class="s">&#39;line&#39;</span><span class="p">,</span> <span class="n">qrsk</span><span class="p">,</span> <span class="n">qret</span><span class="p">,</span> <span class="p">{</span><span class="s">&#39;Turnover &amp; Tracking&#39;</span><span class="p">}},</span> <span class="c">...</span>
     <span class="p">{</span><span class="s">&#39;scatter&#39;</span><span class="p">,</span> <span class="p">[</span><span class="n">mrsk</span><span class="p">,</span> <span class="n">crsk</span><span class="p">],</span> <span class="p">[</span><span class="n">mret</span><span class="p">,</span> <span class="n">cret</span><span class="p">],</span> <span class="p">{</span><span class="s">&#39;Market&#39;</span><span class="p">,</span> <span class="s">&#39;Cash&#39;</span><span class="p">}},</span> <span class="c">...</span>
     <span class="p">{</span><span class="s">&#39;scatter&#39;</span><span class="p">,</span> <span class="n">trsk</span><span class="p">,</span> <span class="n">tret</span><span class="p">,</span> <span class="p">{</span><span class="s">&#39;Tracking&#39;</span><span class="p">},</span> <span class="s">&#39;r&#39;</span><span class="p">},</span> <span class="c">...</span>
     <span class="p">{</span><span class="s">&#39;scatter&#39;</span><span class="p">,</span> <span class="n">ersk</span><span class="p">,</span> <span class="n">eret</span><span class="p">,</span> <span class="p">{</span><span class="s">&#39;Initial&#39;</span><span class="p">},</span> <span class="s">&#39;b&#39;</span><span class="p">});</span></code></pre></div><br><img src="v2-62ab2825860e8343409dfb2f0055d272_720w.jpg" ><h3><b>最大化夏普比率</b></h3><p data-pid="YO6jXO1S">夏普比率（Sharpe 1966）是衡量风险收益率的一种方法，在投资组合分析中起着重要作用。具体来说，根据共同基金定理，最大化夏普比率的投资组合也是有效边界上的相切组合。最大夏普比率投资组合位于函数<code><a href="https://www.mathworks.com/help/finance/portfolio.estimatemaxsharperatio.html" class=" wrap external" target="_blank" rel="nofollow noreferrer">estimateMaxSharpeRatio</a></code>的有效边界上，并且<code><a href="https://www.mathworks.com/help/stats/dataset.html" class=" wrap external" target="_blank" rel="nofollow noreferrer">dataset</a></code>对象用于列出该投资组合中的资产。</p><div class="highlight"><pre><code class="language-matlab"> <span class="n">p</span> <span class="p">=</span> <span class="n">setInitPort</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
 ?
 <span class="n">swgt</span> <span class="p">=</span> <span class="n">estimateMaxSharpeRatio</span><span class="p">(</span><span class="n">p</span><span class="p">);</span>
 <span class="p">[</span><span class="n">srsk</span><span class="p">,</span><span class="n">sret</span><span class="p">]</span> <span class="p">=</span> <span class="n">estimatePortMoments</span><span class="p">(</span><span class="n">p</span><span class="p">,</span><span class="n">swgt</span><span class="p">);</span>
 ?
 <span class="c">% Plot efficient frontier with portfolio that attains maximum Sharpe ratio</span>
 ?
 <span class="n">clf</span><span class="p">;</span>
 <span class="n">portfolioexamples_plot</span><span class="p">(</span><span class="s">&#39;Efficient Frontier with Maximum Sharpe Ratio Portfolio&#39;</span><span class="p">,</span> <span class="c">...</span>
     <span class="p">{</span><span class="s">&#39;line&#39;</span><span class="p">,</span> <span class="n">prsk</span><span class="p">,</span> <span class="n">pret</span><span class="p">},</span> <span class="c">...</span>
     <span class="p">{</span><span class="s">&#39;scatter&#39;</span><span class="p">,</span> <span class="n">srsk</span><span class="p">,</span> <span class="n">sret</span><span class="p">,</span> <span class="p">{</span><span class="s">&#39;Sharpe&#39;</span><span class="p">}},</span> <span class="c">...</span>
     <span class="p">{</span><span class="s">&#39;scatter&#39;</span><span class="p">,</span> <span class="p">[</span><span class="n">mrsk</span><span class="p">,</span> <span class="n">crsk</span><span class="p">,</span> <span class="n">ersk</span><span class="p">],</span> <span class="p">[</span><span class="n">mret</span><span class="p">,</span> <span class="n">cret</span><span class="p">,</span> <span class="n">eret</span><span class="p">],</span> <span class="p">{</span><span class="s">&#39;Market&#39;</span><span class="p">,</span> <span class="s">&#39;Cash&#39;</span><span class="p">,</span> <span class="s">&#39;Equal&#39;</span><span class="p">}},</span> <span class="c">...</span>
     <span class="p">{</span><span class="s">&#39;scatter&#39;</span><span class="p">,</span> <span class="nb">sqrt</span><span class="p">(</span><span class="nb">diag</span><span class="p">(</span><span class="n">p</span><span class="p">.</span><span class="n">AssetCovar</span><span class="p">)),</span> <span class="n">p</span><span class="p">.</span><span class="n">AssetMean</span><span class="p">,</span> <span class="n">p</span><span class="p">.</span><span class="n">AssetList</span><span class="p">,</span> <span class="s">&#39;.r&#39;</span><span class="p">});</span></code></pre></div><br><img src="v2-84b924de40269ef7fa13aa10ed0562e8_720w.jpg" ><div class="highlight"><pre><code class="language-matlab"> <span class="c">% Set up a dataset object that contains the portfolio that maximizes the Sharpe ratio</span>
 ?
 <span class="n">Blotter</span> <span class="p">=</span> <span class="n">dataset</span><span class="p">({</span><span class="mi">100</span><span class="o">*</span><span class="n">swgt</span><span class="p">(</span><span class="n">swgt</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">),</span><span class="s">&#39;Weight&#39;</span><span class="p">},</span> <span class="s">&#39;obsnames&#39;</span><span class="p">,</span> <span class="n">AssetList</span><span class="p">(</span><span class="n">swgt</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">));</span>
 ?
 <span class="n">displayPortfolio</span><span class="p">(</span><span class="s">&#39;Portfolio with Maximum Sharpe Ratio&#39;</span><span class="p">,</span> <span class="n">Blotter</span><span class="p">,</span> <span class="n">false</span><span class="p">);</span>
 <span class="n">Portfolio</span> <span class="n">with</span> <span class="n">Maximum</span> <span class="n">Sharpe</span> <span class="n">Ratio</span>
             <span class="n">Weight</span>    
     <span class="n">AA</span>      <span class="mf">1.9766e-15</span>
     <span class="n">AIG</span>     <span class="mf">1.9146e-15</span>
     <span class="n">AXP</span>     <span class="mf">1.0611e-15</span>
     <span class="n">BA</span>      <span class="mf">5.6229e-16</span>
     <span class="n">C</span>       <span class="mf">2.0142e-15</span>
     <span class="n">CAT</span>     <span class="mf">2.9838e-15</span>
     <span class="n">DD</span>      <span class="mf">3.1459e-16</span>
     <span class="n">DIS</span>     <span class="mf">5.9796e-16</span>
     <span class="n">GE</span>      <span class="mf">5.6384e-15</span>
     <span class="n">GM</span>      <span class="mf">7.3545e-16</span>
     <span class="n">HD</span>      <span class="mf">2.0404e-11</span>
     <span class="n">HON</span>      <span class="mf">3.322e-16</span>
     <span class="n">HPQ</span>     <span class="mf">2.0397e-15</span>
     <span class="n">IBM</span>     <span class="mf">8.9075e-15</span>
     <span class="n">INTC</span>        <span class="mf">2.6638</span>
     <span class="n">JNJ</span>         <span class="mf">9.0044</span>
     <span class="n">JPM</span>     <span class="mf">5.4252e-16</span>
     <span class="n">KO</span>      <span class="mf">2.4688e-16</span>
     <span class="n">MCD</span>      <span class="mf">8.782e-16</span>
     <span class="n">MMM</span>         <span class="mf">15.502</span>
     <span class="n">MO</span>          <span class="mf">13.996</span>
     <span class="n">MRK</span>      <span class="mf">3.235e-16</span>
     <span class="n">MSFT</span>        <span class="mf">4.4777</span>
     <span class="n">PFE</span>     <span class="mf">7.3698e-16</span>
     <span class="n">PG</span>          <span class="mf">7.4588</span>
     <span class="n">SBC</span>     <span class="mf">3.8468e-16</span>
     <span class="n">UTX</span>         <span class="mf">6.0056</span>
     <span class="n">VZ</span>      <span class="mf">3.9213e-16</span>
     <span class="n">WMT</span>         <span class="mf">22.051</span>
     <span class="n">XOM</span>         <span class="mf">18.841</span></code></pre></div><h3><b>确认最大夏普比率是最大的</b></h3><p data-pid="alh6Xyqq">下图说明了此投资组合（位于图中的点处）确实使有效边界上所有投资组合中的夏普比率最大化。</p><div class="highlight"><pre><code class="language-matlab"> <span class="n">psratio</span> <span class="p">=</span> <span class="p">(</span><span class="n">pret</span> <span class="o">-</span> <span class="n">p</span><span class="p">.</span><span class="n">RiskFreeRate</span><span class="p">)</span> <span class="o">./</span> <span class="n">prsk</span><span class="p">;</span>
 <span class="n">ssratio</span> <span class="p">=</span> <span class="p">(</span><span class="n">sret</span> <span class="o">-</span> <span class="n">p</span><span class="p">.</span><span class="n">RiskFreeRate</span><span class="p">)</span> <span class="o">/</span> <span class="n">srsk</span><span class="p">;</span>
 ?
 <span class="n">clf</span><span class="p">;</span>
 <span class="n">subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">);</span>
 <span class="n">plot</span><span class="p">(</span><span class="n">prsk</span><span class="p">,</span> <span class="n">pret</span><span class="p">,</span> <span class="s">&#39;LineWidth&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">);</span>
 <span class="n">hold</span> <span class="n">on</span>
 <span class="n">scatter</span><span class="p">(</span><span class="n">srsk</span><span class="p">,</span> <span class="n">sret</span><span class="p">,</span> <span class="s">&#39;g&#39;</span><span class="p">,</span> <span class="s">&#39;filled&#39;</span><span class="p">);</span>
 <span class="n">title</span><span class="p">(</span><span class="s">&#39;\bfEfficient Frontier&#39;</span><span class="p">);</span>
 <span class="n">xlabel</span><span class="p">(</span><span class="s">&#39;Portfolio Risk&#39;</span><span class="p">);</span>
 <span class="n">ylabel</span><span class="p">(</span><span class="s">&#39;Portfolio Return&#39;</span><span class="p">);</span>
 <span class="n">hold</span> <span class="n">off</span>
 ?
 <span class="n">subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">);</span>
 <span class="n">plot</span><span class="p">(</span><span class="n">prsk</span><span class="p">,</span> <span class="n">psratio</span><span class="p">,</span> <span class="s">&#39;LineWidth&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">);</span>
 <span class="n">hold</span> <span class="n">on</span>
 <span class="n">scatter</span><span class="p">(</span><span class="n">srsk</span><span class="p">,</span> <span class="n">ssratio</span><span class="p">,</span> <span class="s">&#39;g&#39;</span><span class="p">,</span> <span class="s">&#39;filled&#39;</span><span class="p">);</span>
 <span class="n">title</span><span class="p">(</span><span class="s">&#39;\bfSharpe Ratio&#39;</span><span class="p">);</span>
 <span class="n">xlabel</span><span class="p">(</span><span class="s">&#39;Portfolio Risk&#39;</span><span class="p">);</span>
 <span class="n">ylabel</span><span class="p">(</span><span class="s">&#39;Sharpe Ratio&#39;</span><span class="p">);</span>
 <span class="n">hold</span> <span class="n">off</span></code></pre></div><br><img src="v2-e977defd9d4f642bf67cce3d5f0419f4_720w.jpg" ><h3><b>图解夏普值是切线组合</b></h3><p data-pid="Xxx85sCz">下图显示了最大化Sharpe比率的投资组合也是一个相切的投资组合（在这种情况下，开放预算约束以允许使用0％到100％的现金）。</p><div class="highlight"><pre><code class="language-matlab"> <span class="n">q</span> <span class="p">=</span> <span class="n">setBudget</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
 ?
 <span class="n">qwgt</span> <span class="p">=</span> <span class="n">estimateFrontier</span><span class="p">(</span><span class="n">q</span><span class="p">,</span><span class="mi">20</span><span class="p">);</span>
 <span class="p">[</span><span class="n">qrsk</span><span class="p">,</span><span class="n">qret</span><span class="p">]</span> <span class="p">=</span> <span class="n">estimatePortMoments</span><span class="p">(</span><span class="n">q</span><span class="p">,</span><span class="n">qwgt</span><span class="p">);</span>
 ?
 <span class="c">% Plot that shows Sharpe ratio portfolio is the tangency portfolio</span>
 ?
 <span class="n">clf</span><span class="p">;</span>
 <span class="n">portfolioexamples_plot</span><span class="p">(</span><span class="s">&#39;Efficient Frontier with Maximum Sharpe Ratio Portfolio&#39;</span><span class="p">,</span> <span class="c">...</span>
     <span class="p">{</span><span class="s">&#39;line&#39;</span><span class="p">,</span> <span class="n">prsk</span><span class="p">,</span> <span class="n">pret</span><span class="p">},</span> <span class="c">...</span>
     <span class="p">{</span><span class="s">&#39;line&#39;</span><span class="p">,</span> <span class="n">qrsk</span><span class="p">,</span> <span class="n">qret</span><span class="p">,</span> <span class="p">[],</span> <span class="p">[],</span> <span class="mi">1</span><span class="p">},</span> <span class="c">...</span>
     <span class="p">{</span><span class="s">&#39;scatter&#39;</span><span class="p">,</span> <span class="n">srsk</span><span class="p">,</span> <span class="n">sret</span><span class="p">,</span> <span class="p">{</span><span class="s">&#39;Sharpe&#39;</span><span class="p">}},</span> <span class="c">...</span>
     <span class="p">{</span><span class="s">&#39;scatter&#39;</span><span class="p">,</span> <span class="p">[</span><span class="n">mrsk</span><span class="p">,</span> <span class="n">crsk</span><span class="p">,</span> <span class="n">ersk</span><span class="p">],</span> <span class="p">[</span><span class="n">mret</span><span class="p">,</span> <span class="n">cret</span><span class="p">,</span> <span class="n">eret</span><span class="p">],</span> <span class="p">{</span><span class="s">&#39;Market&#39;</span><span class="p">,</span> <span class="s">&#39;Cash&#39;</span><span class="p">,</span> <span class="s">&#39;Equal&#39;</span><span class="p">}},</span> <span class="c">...</span>
     <span class="p">{</span><span class="s">&#39;scatter&#39;</span><span class="p">,</span> <span class="nb">sqrt</span><span class="p">(</span><span class="nb">diag</span><span class="p">(</span><span class="n">p</span><span class="p">.</span><span class="n">AssetCovar</span><span class="p">)),</span> <span class="n">p</span><span class="p">.</span><span class="n">AssetMean</span><span class="p">,</span> <span class="n">p</span><span class="p">.</span><span class="n">AssetList</span><span class="p">,</span> <span class="s">&#39;.r&#39;</span><span class="p">});</span></code></pre></div><br><img src="v2-e49750373955c56104b6ed138e32f386_720w.jpg" ><h3><b>美元中性的对冲基金结构</b></h3><p data-pid="6vt5ad15">为了说明如何在对冲基金管理中使用投资组合优化工具，研究了两种中性的美元对立投资策略和130-30投资组合策略。美元中立策略在多头和空头头寸上均等投资，因此净投资头寸为<code>0</code>。此类投资组合被称为“美元中立”。</p><p data-pid="ncRKrrzQ">要建立与美元中性的投资组合，请从“标准”投资组合问题开始，并在变量<code>Exposure</code>中设置多头和空头头寸的最大敞口。单个资产权重的界限为正或负<code>Exposure</code>。由于净头寸必须与美元中性的，因此预算约束为<code>0</code>，初始投资组合必须为<code>0</code>。最后，单向营业额限制提供了必要的多头和空头限制，以防止多头和空头的“重复计算”。下图显示了美元中性投资组合的投资组合权重，从而使Sharpe比率最大化。多头和空头头寸是从相对于初始投资组合的买卖交易中获得的。</p><div class="highlight"><pre><code class="language-matlab"> <span class="n">Exposure</span> <span class="p">=</span> <span class="mi">1</span><span class="p">;</span>
 ?
 <span class="n">q</span> <span class="p">=</span> <span class="n">setBounds</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="o">-</span><span class="n">Exposure</span><span class="p">,</span> <span class="n">Exposure</span><span class="p">);</span>
 <span class="n">q</span> <span class="p">=</span> <span class="n">setBudget</span><span class="p">(</span><span class="n">q</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
 <span class="n">q</span> <span class="p">=</span> <span class="n">setOneWayTurnover</span><span class="p">(</span><span class="n">q</span><span class="p">,</span> <span class="n">Exposure</span><span class="p">,</span> <span class="n">Exposure</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
 ?
 <span class="p">[</span><span class="n">qwgt</span><span class="p">,</span><span class="n">qlong</span><span class="p">,</span><span class="n">qshort</span><span class="p">]</span> <span class="p">=</span> <span class="n">estimateFrontier</span><span class="p">(</span><span class="n">q</span><span class="p">,</span><span class="mi">20</span><span class="p">);</span>
 <span class="p">[</span><span class="n">qrsk</span><span class="p">,</span><span class="n">qret</span><span class="p">]</span> <span class="p">=</span> <span class="n">estimatePortMoments</span><span class="p">(</span><span class="n">q</span><span class="p">,</span><span class="n">qwgt</span><span class="p">);</span>
 ?
 <span class="p">[</span><span class="n">qswgt</span><span class="p">,</span><span class="n">qslong</span><span class="p">,</span><span class="n">qsshort</span><span class="p">]</span> <span class="p">=</span> <span class="n">estimateMaxSharpeRatio</span><span class="p">(</span><span class="n">q</span><span class="p">);</span>
 <span class="p">[</span><span class="n">qsrsk</span><span class="p">,</span><span class="n">qsret</span><span class="p">]</span> <span class="p">=</span> <span class="n">estimatePortMoments</span><span class="p">(</span><span class="n">q</span><span class="p">,</span><span class="n">qswgt</span><span class="p">);</span>
 ?
 <span class="c">% Plot efficient frontier for a dollar-neutral fund structure with tangency portfolio</span>
 ?
 <span class="n">clf</span><span class="p">;</span>
 <span class="n">portfolioexamples_plot</span><span class="p">(</span><span class="s">&#39;Efficient Frontier with Dollar-Neutral Portfolio&#39;</span><span class="p">,</span> <span class="c">...</span>
     <span class="p">{</span><span class="s">&#39;line&#39;</span><span class="p">,</span> <span class="n">prsk</span><span class="p">,</span> <span class="n">pret</span><span class="p">,</span> <span class="p">{</span><span class="s">&#39;Standard&#39;</span><span class="p">},</span> <span class="s">&#39;b:&#39;</span><span class="p">},</span> <span class="c">...</span>
     <span class="p">{</span><span class="s">&#39;line&#39;</span><span class="p">,</span> <span class="n">qrsk</span><span class="p">,</span> <span class="n">qret</span><span class="p">,</span> <span class="p">{</span><span class="s">&#39;Dollar-Neutral&#39;</span><span class="p">},</span> <span class="s">&#39;b&#39;</span><span class="p">},</span> <span class="c">...</span>
     <span class="p">{</span><span class="s">&#39;scatter&#39;</span><span class="p">,</span> <span class="n">qsrsk</span><span class="p">,</span> <span class="n">qsret</span><span class="p">,</span> <span class="p">{</span><span class="s">&#39;Sharpe&#39;</span><span class="p">}},</span> <span class="c">...</span>
     <span class="p">{</span><span class="s">&#39;scatter&#39;</span><span class="p">,</span> <span class="p">[</span><span class="n">mrsk</span><span class="p">,</span> <span class="n">crsk</span><span class="p">,</span> <span class="n">ersk</span><span class="p">],</span> <span class="p">[</span><span class="n">mret</span><span class="p">,</span> <span class="n">cret</span><span class="p">,</span> <span class="n">eret</span><span class="p">],</span> <span class="p">{</span><span class="s">&#39;Market&#39;</span><span class="p">,</span> <span class="s">&#39;Cash&#39;</span><span class="p">,</span> <span class="s">&#39;Equal&#39;</span><span class="p">}},</span> <span class="c">...</span>
     <span class="p">{</span><span class="s">&#39;scatter&#39;</span><span class="p">,</span> <span class="nb">sqrt</span><span class="p">(</span><span class="nb">diag</span><span class="p">(</span><span class="n">p</span><span class="p">.</span><span class="n">AssetCovar</span><span class="p">)),</span> <span class="n">p</span><span class="p">.</span><span class="n">AssetMean</span><span class="p">,</span> <span class="n">p</span><span class="p">.</span><span class="n">AssetList</span><span class="p">,</span> <span class="s">&#39;.r&#39;</span><span class="p">});</span></code></pre></div><br><img src="v2-b09b2f63080fa9fcdae494772c26f795_720w.jpg" ><div class="highlight"><pre><code class="language-matlab"> <span class="c">% Set up a dataset object that contains the portfolio that maximizes the Sharpe ratio</span>
 ?
 <span class="n">Blotter</span> <span class="p">=</span> <span class="n">dataset</span><span class="p">({</span><span class="mi">100</span><span class="o">*</span><span class="n">qswgt</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">qswgt</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mf">1.0e-4</span><span class="p">),</span> <span class="s">&#39;Weight&#39;</span><span class="p">},</span> <span class="c">...</span>
     <span class="p">{</span><span class="mi">100</span><span class="o">*</span><span class="n">qslong</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">qswgt</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mf">1.0e-4</span><span class="p">),</span> <span class="s">&#39;Long&#39;</span><span class="p">},</span> <span class="c">...</span>
     <span class="p">{</span><span class="mi">100</span><span class="o">*</span><span class="n">qsshort</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">qswgt</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mf">1.0e-4</span><span class="p">),</span> <span class="s">&#39;Short&#39;</span><span class="p">},</span> <span class="c">...</span>
     <span class="s">&#39;obsnames&#39;</span><span class="p">,</span> <span class="n">AssetList</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">qswgt</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mf">1.0e-4</span><span class="p">));</span>
 ?
 <span class="n">displayPortfolio</span><span class="p">(</span><span class="s">&#39;Dollar-Neutral Portfolio with Maximum Sharpe Ratio&#39;</span><span class="p">,</span> <span class="n">Blotter</span><span class="p">,</span> <span class="n">true</span><span class="p">,</span> <span class="s">&#39;Dollar-Neutral&#39;</span><span class="p">);</span>
 <span class="n">Dollar</span><span class="o">-</span><span class="n">Neutral</span> <span class="n">Portfolio</span> <span class="n">with</span> <span class="n">Maximum</span> <span class="n">Sharpe</span> <span class="n">Ratio</span>
             <span class="n">Weight</span>     <span class="n">Long</span>       <span class="n">Short</span> 
     <span class="n">AA</span>       <span class="mf">0.5088</span>     <span class="mf">0.5088</span>         <span class="mi">0</span>
     <span class="n">AIG</span>      <span class="mf">3.0394</span>     <span class="mf">3.0394</span>         <span class="mi">0</span>
     <span class="n">AXP</span>     <span class="mf">0.92797</span>    <span class="mf">0.92797</span>         <span class="mi">0</span>
     <span class="n">BA</span>      <span class="o">-</span><span class="mf">3.4952</span>          <span class="mi">0</span>    <span class="mf">3.4952</span>
     <span class="n">C</span>        <span class="mf">14.003</span>     <span class="mf">14.003</span>         <span class="mi">0</span>
     <span class="n">CAT</span>      <span class="mf">3.7261</span>     <span class="mf">3.7261</span>         <span class="mi">0</span>
     <span class="n">DD</span>      <span class="o">-</span><span class="mf">18.063</span>          <span class="mi">0</span>    <span class="mf">18.063</span>
     <span class="n">DIS</span>     <span class="o">-</span><span class="mf">4.8236</span>          <span class="mi">0</span>    <span class="mf">4.8236</span>
     <span class="n">GE</span>      <span class="o">-</span><span class="mf">3.6178</span>          <span class="mi">0</span>    <span class="mf">3.6178</span>
     <span class="n">GM</span>      <span class="o">-</span><span class="mf">3.7211</span>          <span class="mi">0</span>    <span class="mf">3.7211</span>
     <span class="n">HD</span>        <span class="mf">1.101</span>      <span class="mf">1.101</span>         <span class="mi">0</span>
     <span class="n">HON</span>     <span class="o">-</span><span class="mf">1.4349</span>          <span class="mi">0</span>    <span class="mf">1.4349</span>
     <span class="n">HPQ</span>     <span class="mf">0.09909</span>    <span class="mf">0.09909</span>         <span class="mi">0</span>
     <span class="n">IBM</span>     <span class="o">-</span><span class="mf">8.0585</span>          <span class="mi">0</span>    <span class="mf">8.0585</span>
     <span class="n">INTC</span>     <span class="mf">1.7693</span>     <span class="mf">1.7693</span>         <span class="mi">0</span>
     <span class="n">JNJ</span>      <span class="mf">1.3696</span>     <span class="mf">1.3696</span>         <span class="mi">0</span>
     <span class="n">JPM</span>     <span class="o">-</span><span class="mf">2.5271</span>          <span class="mi">0</span>    <span class="mf">2.5271</span>
     <span class="n">KO</span>      <span class="o">-</span><span class="mf">14.205</span>          <span class="mi">0</span>    <span class="mf">14.205</span>
     <span class="n">MCD</span>        <span class="mf">3.91</span>       <span class="mf">3.91</span>         <span class="mi">0</span>
     <span class="n">MMM</span>      <span class="mf">7.5995</span>     <span class="mf">7.5995</span>         <span class="mi">0</span>
     <span class="n">MO</span>       <span class="mf">4.0856</span>     <span class="mf">4.0856</span>         <span class="mi">0</span>
     <span class="n">MRK</span>       <span class="mf">3.747</span>      <span class="mf">3.747</span>         <span class="mi">0</span>
     <span class="n">MSFT</span>     <span class="mf">4.0769</span>     <span class="mf">4.0769</span>         <span class="mi">0</span>
     <span class="n">PFE</span>      <span class="o">-</span><span class="mf">9.096</span>          <span class="mi">0</span>     <span class="mf">9.096</span>
     <span class="n">PG</span>       <span class="mf">1.6493</span>     <span class="mf">1.6493</span>         <span class="mi">0</span>
     <span class="n">SBC</span>     <span class="o">-</span><span class="mf">5.2547</span>          <span class="mi">0</span>    <span class="mf">5.2547</span>
     <span class="n">UTX</span>      <span class="mf">5.7454</span>     <span class="mf">5.7454</span>         <span class="mi">0</span>
     <span class="n">VZ</span>       <span class="o">-</span><span class="mf">2.438</span>          <span class="mi">0</span>     <span class="mf">2.438</span>
     <span class="n">WMT</span>     <span class="mf">0.84844</span>    <span class="mf">0.84844</span>         <span class="mi">0</span>
     <span class="n">XOM</span>      <span class="mf">18.529</span>     <span class="mf">18.529</span>         <span class="mi">0</span>
 ?
 <span class="n">Confirm</span> <span class="n">Dollar</span><span class="o">-</span><span class="n">Neutral</span> <span class="n">Portfolio</span>
   <span class="p">(</span><span class="n">Net</span><span class="p">,</span> <span class="n">Long</span><span class="p">,</span> <span class="n">Short</span><span class="p">)</span>
 <span class="mf">0.0000</span> <span class="mf">76.7350</span> <span class="mf">76.7350</span> </code></pre></div><h3><b>130/30基金结构</b></h3><p data-pid="ZA5QstsT">最后，周转限制可以用于建立130-30投资组合结构，该结构具有净多头头寸，但允许多头和空头头寸的杠杆达到最大杠杆量。对于130-30的投资组合，杠杆为30％。</p><p data-pid="fY7IQM6B">要设置130-30的投资组合，请从“标准”投资组合问题开始，然后在变量<code>Leverage</code>中设置杠杆的最大值。单个资产权重的范围在<code>-Leverage</code>和<code>1 + Leverage</code>之间。由于净头寸必须是多头，因此预算约束为<code>1</code>，再次，初始投资组合为<code>0</code>。最后，单向营业额限制提供了必要的多头和空头限制，以防止多头和空头的“重复计算”。图表显示了130-30个投资组合的投资组合权重，从而最大化了Sharpe比率。多头和空头头寸是从相对于初始投资组合的买卖交易中获得的。</p><div class="highlight"><pre><code class="language-matlab"> <span class="n">Leverage</span> <span class="p">=</span> <span class="mf">0.3</span><span class="p">;</span>
 ?
 <span class="n">q</span> <span class="p">=</span> <span class="n">setBounds</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="o">-</span><span class="n">Leverage</span><span class="p">,</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">Leverage</span><span class="p">);</span>
 <span class="n">q</span> <span class="p">=</span> <span class="n">setBudget</span><span class="p">(</span><span class="n">q</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
 <span class="n">q</span> <span class="p">=</span> <span class="n">setOneWayTurnover</span><span class="p">(</span><span class="n">q</span><span class="p">,</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">Leverage</span><span class="p">,</span> <span class="n">Leverage</span><span class="p">);</span>
 ?
 <span class="p">[</span><span class="n">qwgt</span><span class="p">,</span><span class="n">qbuy</span><span class="p">,</span><span class="n">qsell</span><span class="p">]</span> <span class="p">=</span> <span class="n">estimateFrontier</span><span class="p">(</span><span class="n">q</span><span class="p">,</span><span class="mi">20</span><span class="p">);</span>
 <span class="p">[</span><span class="n">qrsk</span><span class="p">,</span><span class="n">qret</span><span class="p">]</span> <span class="p">=</span> <span class="n">estimatePortMoments</span><span class="p">(</span><span class="n">q</span><span class="p">,</span><span class="n">qwgt</span><span class="p">);</span>
 ?
 <span class="p">[</span><span class="n">qswgt</span><span class="p">,</span><span class="n">qslong</span><span class="p">,</span><span class="n">qsshort</span><span class="p">]</span> <span class="p">=</span> <span class="n">estimateMaxSharpeRatio</span><span class="p">(</span><span class="n">q</span><span class="p">);</span>
 <span class="p">[</span><span class="n">qsrsk</span><span class="p">,</span><span class="n">qsret</span><span class="p">]</span> <span class="p">=</span> <span class="n">estimatePortMoments</span><span class="p">(</span><span class="n">q</span><span class="p">,</span><span class="n">qswgt</span><span class="p">);</span>
 ?
 <span class="c">% Plot efficient frontier for a 130-30 fund structure with tangency portfolio</span>
 ?
 <span class="n">clf</span><span class="p">;</span>
 <span class="n">portfolioexamples_plot</span><span class="p">(</span><span class="n">sprintf</span><span class="p">(</span><span class="s">&#39;Efficient Frontier with %g-%g Portfolio&#39;</span><span class="p">,</span> <span class="c">...</span>
     <span class="mi">100</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">Leverage</span><span class="p">),</span><span class="mi">100</span><span class="o">*</span><span class="n">Leverage</span><span class="p">),</span> <span class="c">...</span>
     <span class="p">{</span><span class="s">&#39;line&#39;</span><span class="p">,</span> <span class="n">prsk</span><span class="p">,</span> <span class="n">pret</span><span class="p">,</span> <span class="p">{</span><span class="s">&#39;Standard&#39;</span><span class="p">},</span> <span class="s">&#39;b:&#39;</span><span class="p">},</span> <span class="c">...</span>
     <span class="p">{</span><span class="s">&#39;line&#39;</span><span class="p">,</span> <span class="n">qrsk</span><span class="p">,</span> <span class="n">qret</span><span class="p">,</span> <span class="p">{</span><span class="s">&#39;130-30&#39;</span><span class="p">},</span> <span class="s">&#39;b&#39;</span><span class="p">},</span> <span class="c">...</span>
     <span class="p">{</span><span class="s">&#39;scatter&#39;</span><span class="p">,</span> <span class="n">qsrsk</span><span class="p">,</span> <span class="n">qsret</span><span class="p">,</span> <span class="p">{</span><span class="s">&#39;Sharpe&#39;</span><span class="p">}},</span> <span class="c">...</span>
     <span class="p">{</span><span class="s">&#39;scatter&#39;</span><span class="p">,</span> <span class="p">[</span><span class="n">mrsk</span><span class="p">,</span> <span class="n">crsk</span><span class="p">,</span> <span class="n">ersk</span><span class="p">],</span> <span class="p">[</span><span class="n">mret</span><span class="p">,</span> <span class="n">cret</span><span class="p">,</span> <span class="n">eret</span><span class="p">],</span> <span class="p">{</span><span class="s">&#39;Market&#39;</span><span class="p">,</span> <span class="s">&#39;Cash&#39;</span><span class="p">,</span> <span class="s">&#39;Equal&#39;</span><span class="p">}},</span> <span class="c">...</span>
     <span class="p">{</span><span class="s">&#39;scatter&#39;</span><span class="p">,</span> <span class="nb">sqrt</span><span class="p">(</span><span class="nb">diag</span><span class="p">(</span><span class="n">p</span><span class="p">.</span><span class="n">AssetCovar</span><span class="p">)),</span> <span class="n">p</span><span class="p">.</span><span class="n">AssetMean</span><span class="p">,</span> <span class="n">p</span><span class="p">.</span><span class="n">AssetList</span><span class="p">,</span> <span class="s">&#39;.r&#39;</span><span class="p">});</span></code></pre></div><br><img src="v2-d7687a87a7b1a5c1c7385c84ea5cac67_720w.jpg" ><div class="highlight"><pre><code class="language-matlab"> <span class="c">% Set up a dataset object that contains the portfolio that maximizes the Sharpe ratio</span>
 ?
 <span class="n">Blotter</span> <span class="p">=</span> <span class="n">dataset</span><span class="p">({</span><span class="mi">100</span><span class="o">*</span><span class="n">qswgt</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">qswgt</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mf">1.0e-4</span><span class="p">),</span> <span class="s">&#39;Weight&#39;</span><span class="p">},</span> <span class="c">...</span>
     <span class="p">{</span><span class="mi">100</span><span class="o">*</span><span class="n">qslong</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">qswgt</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mf">1.0e-4</span><span class="p">),</span> <span class="s">&#39;Long&#39;</span><span class="p">},</span> <span class="c">...</span>
     <span class="p">{</span><span class="mi">100</span><span class="o">*</span><span class="n">qsshort</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">qswgt</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mf">1.0e-4</span><span class="p">),</span> <span class="s">&#39;Short&#39;</span><span class="p">},</span> <span class="c">...</span>
     <span class="s">&#39;obsnames&#39;</span><span class="p">,</span> <span class="n">AssetList</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">qswgt</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mf">1.0e-4</span><span class="p">));</span>
 ?
 <span class="n">displayPortfolio</span><span class="p">(</span><span class="n">sprintf</span><span class="p">(</span><span class="s">&#39;%g-%g Portfolio with Maximum Sharpe Ratio&#39;</span><span class="p">,</span> <span class="mi">100</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">Leverage</span><span class="p">),</span> <span class="mi">100</span><span class="o">*</span><span class="n">Leverage</span><span class="p">),</span> <span class="n">Blotter</span><span class="p">,</span> <span class="n">true</span><span class="p">,</span> <span class="n">sprintf</span><span class="p">(</span><span class="s">&#39;%g-%g&#39;</span><span class="p">,</span> <span class="mi">100</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">Leverage</span><span class="p">),</span> <span class="mi">100</span><span class="o">*</span><span class="n">Leverage</span><span class="p">));</span>
 <span class="mi">130</span><span class="o">-</span><span class="mi">30</span> <span class="n">Portfolio</span> <span class="n">with</span> <span class="n">Maximum</span> <span class="n">Sharpe</span> <span class="n">Ratio</span>
             <span class="n">Weight</span>      <span class="n">Long</span>      <span class="n">Short</span>  
     <span class="n">DD</span>       <span class="o">-</span><span class="mf">9.5565</span>         <span class="mi">0</span>     <span class="mf">9.5565</span>
     <span class="n">HON</span>      <span class="o">-</span><span class="mf">6.0244</span>         <span class="mi">0</span>     <span class="mf">6.0244</span>
     <span class="n">INTC</span>      <span class="mf">4.0335</span>    <span class="mf">4.0335</span>          <span class="mi">0</span>
     <span class="n">JNJ</span>       <span class="mf">7.1234</span>    <span class="mf">7.1234</span>          <span class="mi">0</span>
     <span class="n">JPM</span>     <span class="o">-</span><span class="mf">0.44583</span>         <span class="mi">0</span>    <span class="mf">0.44583</span>
     <span class="n">KO</span>       <span class="o">-</span><span class="mf">13.646</span>         <span class="mi">0</span>     <span class="mf">13.646</span>
     <span class="n">MMM</span>       <span class="mf">20.908</span>    <span class="mf">20.908</span>          <span class="mi">0</span>
     <span class="n">MO</span>        <span class="mf">14.433</span>    <span class="mf">14.433</span>          <span class="mi">0</span>
     <span class="n">MSFT</span>      <span class="mf">4.5592</span>    <span class="mf">4.5592</span>          <span class="mi">0</span>
     <span class="n">PG</span>        <span class="mf">17.243</span>    <span class="mf">17.243</span>          <span class="mi">0</span>
     <span class="n">SBC</span>     <span class="o">-</span><span class="mf">0.32712</span>         <span class="mi">0</span>    <span class="mf">0.32712</span>
     <span class="n">UTX</span>       <span class="mf">5.3584</span>    <span class="mf">5.3584</span>          <span class="mi">0</span>
     <span class="n">WMT</span>       <span class="mf">21.018</span>    <span class="mf">21.018</span>          <span class="mi">0</span>
     <span class="n">XOM</span>       <span class="mf">35.323</span>    <span class="mf">35.323</span>          <span class="mi">0</span>
 ?
 <span class="n">Confirm</span> <span class="mi">130</span><span class="o">-</span><span class="mi">30</span> <span class="n">Portfolio</span>
   <span class="p">(</span><span class="n">Net</span><span class="p">,</span> <span class="n">Long</span><span class="p">,</span> <span class="n">Short</span><span class="p">)</span>
 <span class="mf">100.0000</span> <span class="mf">130.0000</span> <span class="mf">30.0000</span> </code></pre></div><h3><b>参考文献</b></h3><ol><li data-pid="mRKd4ieK">R. C. Grinold and R. N. Kahn. <i>Active Portfolio Management.</i> 2nd ed.,2000.</li><li data-pid="fAQ3nzp0">H. M. Markowitz. &#34;Portfolio Selection.&#34; <i>Journal of Finance.</i> Vol. 1, No. 1, pp. 77-91, 1952.</li><li data-pid="5dHq-sPT">J. Lintner. &#34;The Valuation of Risk Assets and the Selection of Risky Investments in Stock Portfolios and Capital Budgets.&#34; <i>Review of Economics and Statistics.</i> Vol. 47, No. 1, pp. 13-37, 1965.</li><li data-pid="hmdatB5A">H. M. Markowitz. <i>Portfolio Selection: Efficient Diversification of Investments.</i> John Wiley &amp; Sons, Inc., 1959.</li><li data-pid="H2IDu9uj">W. F. Sharpe. &#34;Mutual Fund Performance.&#34; <i>Journal of Business.</i> Vol. 39, No. 1, Part 2, pp. 119-138, 1966.</li><li data-pid="l3oyZHhc">J. Tobin. &#34;Liquidity Preference as Behavior Towards Risk.&#34; <i>Review of Economic Studies.</i> Vol. 25, No.1, pp. 65-86, 1958.</li><li data-pid="8mQtLoNF">J. L. Treynor and F. Black. &#34;How to Use Security Analysis to Improve Portfolio Selection.&#34; <i>Journal of Business.</i> Vol. 46, No. 1, pp. 68-86, 1973.</li></ol><h3><b>工具函数</b></h3><div class="highlight"><pre><code class="language-matlab"><span class="k"> function</span><span class="w"> </span><span class="nf">displaySumOfTransactions</span><span class="p">(</span>Turnover, qbuy, qsell<span class="p">)</span><span class="w">
</span><span class="w"> </span><span class="n">fprintf</span><span class="p">(</span><span class="s">&#39;Sum of Purchases by Portfolio along Efficient Frontier (Max. Turnover %g%%)\n&#39;</span><span class="p">,</span> <span class="c">...</span>
     <span class="mi">100</span><span class="o">*</span><span class="n">Turnover</span><span class="p">);</span>
 <span class="n">fprintf</span><span class="p">(</span><span class="s">&#39;%.4f &#39;</span><span class="p">,</span> <span class="mi">100</span><span class="o">*</span><span class="n">sum</span><span class="p">(</span><span class="n">qbuy</span><span class="p">)),</span> <span class="n">sprintf</span><span class="p">(</span><span class="s">&#39;\n\n&#39;</span><span class="p">);</span>
 <span class="n">fprintf</span><span class="p">(</span><span class="s">&#39;\n&#39;</span><span class="p">)</span>
 <span class="n">fprintf</span><span class="p">(</span><span class="s">&#39;Sum of Sales by Portfolio along Efficient Frontier (Max. Turnover %g%%)\n&#39;</span><span class="p">,</span> <span class="c">...</span>
     <span class="mi">100</span><span class="o">*</span><span class="n">Turnover</span><span class="p">);</span>
 <span class="n">fprintf</span><span class="p">(</span><span class="s">&#39;%.4f &#39;</span><span class="p">,</span> <span class="mi">100</span><span class="o">*</span><span class="n">sum</span><span class="p">(</span><span class="n">qsell</span><span class="p">));</span>
 <span class="k">end</span>
 ?
<span class="k"> function</span><span class="w"> </span><span class="nf">displayPortfolio</span><span class="p">(</span>Description, Blotter, LongShortFlag, portfolioType<span class="p">)</span><span class="w">
</span><span class="w"> </span><span class="n">fprintf</span><span class="p">(</span><span class="s">&#39;%s\n&#39;</span><span class="p">,</span> <span class="n">Description</span><span class="p">);</span>
 <span class="nb">disp</span><span class="p">(</span><span class="n">Blotter</span><span class="p">);</span>
 <span class="k">if</span> <span class="p">(</span><span class="n">LongShortFlag</span><span class="p">)</span>
     <span class="n">fprintf</span><span class="p">(</span><span class="s">&#39;Confirm %s Portfolio\n&#39;</span><span class="p">,</span> <span class="n">portfolioType</span><span class="p">);</span>
     <span class="n">fprintf</span><span class="p">(</span><span class="s">&#39;  (Net, Long, Short)\n&#39;</span><span class="p">);</span>
     <span class="n">fprintf</span><span class="p">(</span><span class="s">&#39;%.4f &#39;</span> <span class="p">,</span> <span class="p">[</span> <span class="n">sum</span><span class="p">(</span><span class="n">Blotter</span><span class="p">.</span><span class="n">Weight</span><span class="p">),</span> <span class="n">sum</span><span class="p">(</span><span class="n">Blotter</span><span class="p">.</span><span class="n">Long</span><span class="p">),</span> <span class="n">sum</span><span class="p">(</span><span class="n">Blotter</span><span class="p">.</span><span class="n">Short</span><span class="p">)</span> <span class="p">]);</span>
 <span class="k">end</span>
 <span class="k">end</span></code></pre></div><hr/><p data-pid="W8R2A6PO">注：本文根据MATLAB官网内容修改而成。</p>
</p>
<p>
<br> ======================================================================
<br><strong> 我的测试结果及程序  </strong>
<br>下面是我测试的代码：
<pre>

 
</pre>
<br> <img src="myTestResult.png"   width="868px" height="478px">


</p>



                            </div>
                        </article>
                    </div>
                </div>
            </div>
          <footer id="colophon" role="contentinfo">
	<div id="site-generator">孙悟空 from 吉林大学自动化 @ sunwukong@sangkeji.com</div>
	<script src="../../../footer.js"></script>
          </footer>
        </div>
    </body>
</html>
